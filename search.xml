<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Docker部署Redis</title>
      <link href="/2022/08/21/Docker%E9%83%A8%E7%BD%B2Redis/"/>
      <url>/2022/08/21/Docker%E9%83%A8%E7%BD%B2Redis/</url>
      
        <content type="html"><![CDATA[<h4 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h4><p>拉取竟像时报错，报错内容如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error response from daemon: Get &quot;https://registry-1.docker.io/v2/&quot;: dial tcp 44.194.5.25:443: connect: network is unreachable</span><br></pre></td></tr></table></figure><img src="\img\redis\redis01.png" style="zoom:33%;" /><p><strong>解决方案</strong>：</p><p><strong>第1步</strong>：找到并编辑 <code>ifcfg-ens33</code> 文件。执行如下代码，进入文件中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /ect/sysconfig/network-scripts/ifcfg-ens33</span><br></pre></td></tr></table></figure><img src="\img\redis\redis03.png" style="zoom:33%;" /><p>在其配置后加入下面代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DNS1=8.8.8.8</span><br></pre></td></tr></table></figure><img src="\img\redis\redis02.png" style="zoom:33%;" /><p><strong>第2步</strong>：找到并编辑 <code>resolv.conf</code> 文件，执行如下代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/resolv.conf</span><br></pre></td></tr></table></figure><img src="\img\redis\redis04.png" style="zoom:33%;" /><p><strong>第3步</strong>：执行下面代码，重启网络服务和 <code>docker</code> 服务。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service network restart  #重启网络服务</span><br><span class="line">service docker restart  #重启docker服务</span><br></pre></td></tr></table></figure><img src="\img\redis\redis05.png" style="zoom:33%;" /><p>拉取 <code>redis</code> 时，还是不能拉取。</p><p><strong>第4步</strong>：查看 <code>ifcfg-ens33</code> 文件。</p><img src="\img\redis\redis06.png" style="zoom:33%;" /><p><strong>第5步</strong>：配置子网掩码和网关。子网IP、子网掩码和网关IP可以通过虚拟机上查找。</p><p>查找路径：打开编辑 &gt; 虚拟网络编辑器 &gt; NAT设置</p><p>子网IP和子网掩码：</p><img src="\img\redis\redis07.png" style="zoom:33%;" /><p>网关IP：</p><img src="\img\redis\redis08.png" style="zoom:33%;" /><p>配置完成后的完整文件内容如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">TYPE=<span class="string">&quot;Ethernet&quot;</span>  <span class="comment">#网卡类型：为以太网</span></span><br><span class="line">PROXY_METHOD=<span class="string">&quot;none&quot;</span>  <span class="comment">#代理方式：关闭状态</span></span><br><span class="line">BROWSER_ONLY=<span class="string">&quot;no&quot;</span>  <span class="comment">#只是浏览器：否</span></span><br><span class="line">BOOTPROTO=<span class="string">&quot;static&quot;</span>  <span class="comment">#网卡协议DHCP动态主机配置协议</span></span><br><span class="line">IPADDR=<span class="string">&quot;192.168.171.129&quot;</span>  <span class="comment">#ip地址（static设置）</span></span><br><span class="line">DEFROUTE=<span class="string">&quot;yes&quot;</span>  <span class="comment">#默认路由：是</span></span><br><span class="line">IPV4_FAILURE_FATAL=<span class="string">&quot;no&quot;</span>  <span class="comment">#是否开启IPV4致命错误检测：否</span></span><br><span class="line">IPV6INIT=<span class="string">&quot;yes&quot;</span>  <span class="comment">#IPV6是否自动初始化：是</span></span><br><span class="line">IPV6_AUTOCONF=<span class="string">&quot;yes&quot;</span>  <span class="comment">#IPV6是否自动配置：是</span></span><br><span class="line">IPV6_DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_FAILURE_FATAL=<span class="string">&quot;no&quot;</span></span><br><span class="line"><span class="comment">#stable-privacy是一种生成IPV6的策略 </span></span><br><span class="line">IPV6_ADDR_GEN_MODE=<span class="string">&quot;stable-privacy&quot;</span>  <span class="comment">#IPV6地址生成模型</span></span><br><span class="line">NAME=<span class="string">&quot;ens33&quot;</span>  <span class="comment">#网卡名字（与DEVICE一致）</span></span><br><span class="line">UUID=<span class="string">&quot;05d76021-b6db-49c9-ae01-af1f5afe51e3&quot;</span>  <span class="comment">#唯一标识码</span></span><br><span class="line">DEVICE=<span class="string">&quot;ens33&quot;</span>  <span class="comment">#网卡设备</span></span><br><span class="line">ONBOOT=<span class="string">&quot;yes&quot;</span>  <span class="comment">#是否激活网卡</span></span><br><span class="line">DNS1=114.114.114.114  <span class="comment">#dns地址解析</span></span><br><span class="line">NETMASK=255.255.255.0  <span class="comment">#子网掩码</span></span><br><span class="line">GATEWAY=192.168.171.2  <span class="comment">#网关</span></span><br></pre></td></tr></table></figure><img src="\img\redis\redis09.png" style="zoom:33%;" /><p><strong>第6步</strong>：编辑 <code>resolv.conf</code> 文件，将 <code>8.8.8.8</code> 改成 <code>114.114.114.114</code>。</p><img src="\img\redis\redis11.png" style="zoom:33%;" /><p><strong>第7步</strong>：重启网络服务，并拉取 <code>redis</code> 镜像。</p><img src="\img\redis\redis10.png" style="zoom:33%;" /><h4 id="查看镜像"><a href="#查看镜像" class="headerlink" title="查看镜像"></a>查看镜像</h4><p>使用下面命令查看 <code>docker</code> 服务中的全部镜像。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><img src="\img\redis\redis12.png" style="zoom:33%;" /><h4 id="创建并运行容器"><a href="#创建并运行容器" class="headerlink" title="创建并运行容器"></a>创建并运行容器</h4><p>创建 <code>redis</code> 容器，设置端口映射，并运行容器，</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -id --restart=always  --name=redis -p 6379:6379 redis:5.0</span><br></pre></td></tr></table></figure><img src="\img\redis\redis13.png" style="zoom:33%;" /><p>注意：</p><ul><li><p>–restart&#x3D;always ：当 <code>docker</code> 重启时，自动重启容器；</p></li><li><p>–name&#x3D;redis ：将容器名称设置为 redis；</p></li></ul><p>使用 <code>docker ps</code> 命令查看运行的容器，查看全部容器可以使用 <code>docker ps -a</code> 。</p><h4 id="进入容器"><a href="#进入容器" class="headerlink" title="进入容器"></a>进入容器</h4><p>执行如下命令进入 <code>redis</code> 容器中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it redis /bin/bash</span><br></pre></td></tr></table></figure><img src="\img\redis\redis14.png" style="zoom:33%;" /><p><code>exit</code> 命令是退出容器。</p><h4 id="本地连接容器"><a href="#本地连接容器" class="headerlink" title="本地连接容器"></a>本地连接容器</h4><p>连接失败！！！失败内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not connect to Redis at 192.168.171.129:6379: 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。</span><br></pre></td></tr></table></figure><img src="\img\redis\redis15.png" style="zoom:33%;" /><p><strong>解决方法</strong>：</p><p><strong>第1步</strong>：找到并编辑 <code>sysctl.conf</code> 文件。执行代码如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysctl.conf</span><br></pre></td></tr></table></figure><p><strong>第2步</strong>：添加如下代码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.ip_forward=1</span><br></pre></td></tr></table></figure><img src="\img\redis\redis16.png" style="zoom:33%;" /><p><strong>第3步</strong>：重启 <code>network</code> 服务。执行代码如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><p>查看刚才相关的内容是否修改成功：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.ipv4.ip_forward</span><br></pre></td></tr></table></figure><img src="\img\redis\redis17.png" style="zoom:33%;" /><p><strong>第4步</strong>：重新使用本地 <code>redis</code> 工具连接 <code>docker</code> 服务上的 <code>redis</code> 容器。</p><img src="\img\redis\redis18.png" style="zoom:33%;" /><p>连接成功后，操作redis：</p><img src="\img\redis\redis19.png" style="zoom:33%;" />]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot整合MongoDB</title>
      <link href="/2022/08/17/SpringBoot%E6%95%B4%E5%90%88MongoDB/"/>
      <url>/2022/08/17/SpringBoot%E6%95%B4%E5%90%88MongoDB/</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>spring-data-mongodb 提供了 MongoTemplate 与 MongoRepository 两种方式访问 mongodb。MongoRepository 操作简单，MongoTemplate 操作灵活，在项目中可以灵活适用这两种方式操作 mongodb。MongoRepository 的缺点是不够灵活，MongoTemplate 正好可以弥补不足。</p><h3 id="搭建开发环境"><a href="#搭建开发环境" class="headerlink" title="搭建开发环境"></a>搭建开发环境</h3><blockquote><p>使用 Spring Initializr 快速初始化一个 Spring Boot 工程</p></blockquote><img src="\img\mongodb\springmgdb101.png" style="zoom:33%;" /><blockquote><p>引入依赖</p></blockquote><p>在 pom.xml 文件中添加相关依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mongodb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mongodb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mongodb<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>mongodb<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--日期工具类--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--SpringBoot测试依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>添加配置</p></blockquote><p>在 application.properties 文件添加连接 MongoDB 的地址。</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.data.mongodb.uri</span>=<span class="string">mongodb://192.168.171.129:27017/test</span></span><br></pre></td></tr></table></figure><blockquote><p>启动虚拟机上的 MongoDB。</p></blockquote><img src="\img\mongodb\springmgdb102.png" style="zoom:33%;" /><blockquote><p>创建实体类</p></blockquote><p>在工程中，创建User实体类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span>   <span class="comment">//使用lombok内的方法，设置实体类的getter、setter方法</span></span><br><span class="line"><span class="meta">@Document(&quot;User&quot;)</span>    <span class="comment">//指明操作的表/集合</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span>   <span class="comment">//设置mongodb中的_id值</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String createDate;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通过MongoTemplate进行CRUD操作"><a href="#通过MongoTemplate进行CRUD操作" class="headerlink" title="通过MongoTemplate进行CRUD操作"></a>通过MongoTemplate进行CRUD操作</h3><p>CRUD：增、删、改、查</p><p><strong>常用方法</strong>：</p><ul><li>mongoTemplate.findAll(User.class)：查询User文档的全部数据</li><li>mongoTemplate.findById(<id>, User.class)：查询User文档id为id的数据</li><li>mongoTemplate.find(query, User.class)：根据query内的查询条件查询</li><li>mongoTemplate.upsert(query, update, User.class)：修改</li><li>mongoTemplate.remove(query, User.class)：删除</li><li>mongoTemplate.insert(User)：新增</li></ul><p>Query 对象<br> 1、创建一个query对象（用来封装所有条件对象)，再创建一个criteria对象（用来构建条件）<br> 2、 精准条件：criteria.and(“key”).is(“条件”)<br> 模糊条件：criteria.and(“key”).regex(“条件”)<br> 3、封装条件：query.addCriteria(criteria)<br> 4、大于（创建新的criteria）：Criteria gt &#x3D; Criteria.where(“key”).gt（“条件”）<br> 小于（创建新的criteria）：Criteria lt &#x3D; Criteria.where(“key”).lt（“条件”）<br> 5、Query.addCriteria(new Criteria().andOperator(gt,lt));<br> 6、一个query中只能有一个andOperator()。其参数也可以是Criteria数组。<br> 7、排序 ：query.with（new Sort(Sort.Direction.ASC, “age”). and(new Sort(Sort.Direction.DESC, “date”)))</p><h4 id="添加操作"><a href="#添加操作" class="headerlink" title="添加操作"></a>添加操作</h4><p>在 MongodbApplicationTests 测试类中注入 MongoTemplate，在测试类中编写添加操作的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MongodbApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注入MongoTemplate</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MongoTemplate mongoTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加操作</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">create</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setName(<span class="string">&quot;王二&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">25</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;222@qq.com&quot;</span>);</span><br><span class="line">        user.setCreateDate(<span class="string">&quot;2022.6.19&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> mongoTemplate.insert(user);</span><br><span class="line">        System.out.println(user1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行添加方法后的结果：</p><img src="\img\mongodb\springmgdb103.png" style="zoom: 25%;" /><p>虚拟机查询MongoDB内的数据：</p><img src="\img\mongodb\springmgdb104.png" style="zoom:33%;" /><h4 id="查询操作"><a href="#查询操作" class="headerlink" title="查询操作"></a>查询操作</h4><blockquote><p>查询集合中所有记录</p></blockquote><p>在测试类中编写查询所有记录的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询集合中所有记录</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">       List&lt;User&gt; users = mongoTemplate.findAll(User.class);</span><br><span class="line">       users.forEach(System.out::println);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb105.png" style="zoom:25%;" /><blockquote><p>根据id查询集合中的记录</p></blockquote><p>在测试类中编写根据id查询记录的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询集合中的记录</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findById</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mongoTemplate.findById(<span class="string">&quot;62fc4a68eb2f0747655a243c&quot;</span>, User.class);</span><br><span class="line">       System.out.println(user);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb106.png" style="zoom:25%;" /><blockquote><p>条件查询：根据name和age查询</p></blockquote><p>在测试类中编写根据name和age查询记录的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条件查询：根据name和age查询</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findByNameAndAge</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//使用Query方法中的Criteria方式构建条件（即name=麻子，age=22）</span></span><br><span class="line">       <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Query</span>(Criteria.where(<span class="string">&quot;name&quot;</span>).is(<span class="string">&quot;麻子&quot;</span>).and(<span class="string">&quot;age&quot;</span>).is(<span class="number">22</span>));</span><br><span class="line">       List&lt;User&gt; users = mongoTemplate.find(query, User.class);</span><br><span class="line">       System.out.println(users);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb107.png" style="zoom:25%;" /><blockquote><p>模糊查询</p></blockquote><p>在测试类中编写模糊查询方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模糊查询</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findLikeList</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">/* 查询name中包含“王”的User集合记录 */</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;王&quot;</span>;</span><br><span class="line">       <span class="comment">/* 使用正则表达式拼接 */</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">regex</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s%s%s&quot;</span>, <span class="string">&quot;^.*&quot;</span>, name, <span class="string">&quot;.*$&quot;</span>);</span><br><span class="line">       <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regex,Pattern.CASE_INSENSITIVE);</span><br><span class="line">       <span class="comment">//使用Query方法中的Criteria方式构建条件</span></span><br><span class="line">       <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Query</span>(Criteria.where(<span class="string">&quot;name&quot;</span>).regex(pattern));</span><br><span class="line">       <span class="comment">/* 调用find方法实现模糊查询 */</span></span><br><span class="line">       List&lt;User&gt; users = mongoTemplate.find(query, User.class);</span><br><span class="line">       System.out.println(users);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb108.png" style="zoom:25%;" /><blockquote><p>分页查询</p></blockquote><p>在测试类中编写分页查询方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分页查询</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findPageUserList</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">int</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">//当前页</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">3</span>;  <span class="comment">//每页显示的记录数</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;王&quot;</span>;</span><br><span class="line">       <span class="comment">/* 条件构建 */</span></span><br><span class="line">       <span class="type">String</span> <span class="variable">regex</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s%s%s&quot;</span>, <span class="string">&quot;^.*&quot;</span>, name, <span class="string">&quot;.*$&quot;</span>);</span><br><span class="line">       <span class="type">Pattern</span> <span class="variable">pattern</span> <span class="operator">=</span> Pattern.compile(regex,Pattern.CASE_INSENSITIVE);</span><br><span class="line">       <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Query</span>(Criteria.where(<span class="string">&quot;name&quot;</span>).regex(pattern));</span><br><span class="line">       <span class="comment">/* 分页构建 */</span></span><br><span class="line">       <span class="comment">//查询记录数</span></span><br><span class="line">       <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> mongoTemplate.count(query, User.class);</span><br><span class="line">       <span class="comment">//分页</span></span><br><span class="line">       List&lt;User&gt; users = mongoTemplate.find(</span><br><span class="line">               query.skip((pageNo - <span class="number">1</span>) * pageSize).limit(pageSize), User.class);</span><br><span class="line">       System.out.println(count);</span><br><span class="line">       System.out.println(users);</span><br><span class="line">       users.forEach(System.out::println);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb109.png" style="zoom:25%;" /><h4 id="修改操作"><a href="#修改操作" class="headerlink" title="修改操作"></a>修改操作</h4><p>在测试类中编写修改的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改操作</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//根据id查询</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mongoTemplate.findById(<span class="string">&quot;62fc55c9687faf1ad2c15069&quot;</span>, User.class);</span><br><span class="line">       System.out.println(user);</span><br><span class="line">       <span class="comment">//设置修改值</span></span><br><span class="line">       user.setName(<span class="string">&quot;吴杰&quot;</span>);</span><br><span class="line">       user.setEmail(<span class="string">&quot;666@qq.com&quot;</span>);</span><br><span class="line">       user.setAge(<span class="number">99</span>);</span><br><span class="line">       <span class="comment">//调用方法实现修改操作</span></span><br><span class="line">       <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Query</span>(Criteria.where(<span class="string">&quot;_id&quot;</span>).is(user.getId()));</span><br><span class="line">       <span class="type">Update</span> <span class="variable">update</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Update</span>();</span><br><span class="line">       update.set(<span class="string">&quot;name&quot;</span>,user.getName());</span><br><span class="line">       update.set(<span class="string">&quot;email&quot;</span>,user.getEmail());</span><br><span class="line">       update.set(<span class="string">&quot;age&quot;</span>,user.getAge());</span><br><span class="line">       <span class="type">UpdateResult</span> <span class="variable">result</span> <span class="operator">=</span> mongoTemplate.upsert(query, update, User.class);</span><br><span class="line">       <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> result.getModifiedCount();</span><br><span class="line">       System.out.println(count);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb110.png" style="zoom:25%;" /><h4 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h4><p>查询mongodb数据库中User集合的全部数据：</p><img src="\img\mongodb\springmgdb111.png" style="zoom:33%;" /><p>在测试类中编写删除的方法。将 name为王爷的数据删除。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除操作</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">Query</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Query</span>(Criteria.where(<span class="string">&quot;_id&quot;</span>).is(<span class="string">&quot;62fc55e5a53f096e37f58bbc&quot;</span>));</span><br><span class="line">       <span class="type">DeleteResult</span> <span class="variable">remove</span> <span class="operator">=</span> mongoTemplate.remove(query, User.class);</span><br><span class="line">       <span class="type">long</span> <span class="variable">deletedCount</span> <span class="operator">=</span> remove.getDeletedCount();</span><br><span class="line">       System.out.println(deletedCount);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb112.png" style="zoom:25%;" /><p>数据库数据：</p><img src="\img\mongodb\springmgdb113.png" style="zoom:33%;" /><h3 id="通过MongoRepository进行CRUD操作"><a href="#通过MongoRepository进行CRUD操作" class="headerlink" title="通过MongoRepository进行CRUD操作"></a>通过MongoRepository进行CRUD操作</h3><p>在 Spring Data 中提供了对 MongoDB 数据访问的支持，我们只需要继承 MongoRepository 类，按照 Spring Data 规范就可实现 CRUD 操作。</p><p>SpringData 方法定义规范：</p><p>注意：</p><p>1、不是随便声明的，而需要符合一定的规范；<br>2、 查询方法以 find | read | get 开头；<br>3、 涉及条件查询时，条件的属性用条件关键字连接。要注意的是：条件属性首字母需要大写；<br>5、 支持属性的级联查询，但若当前类有符合条件的属性则优先使用，而不使用级联属性，若需要使用级联属性，则属性之间使用 <code>_ </code> 符合强制进行连接。</p><h4 id="操作前准备"><a href="#操作前准备" class="headerlink" title="操作前准备"></a>操作前准备</h4><p>创建 UserRepository 接口，让其继承 MongoRepository 类。使用 @Repository 注解，注明 UserRepository 接口为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserRepository</span> <span class="keyword">extends</span> <span class="title class_">MongoRepository</span>&lt;User,String&gt; &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建 MongoRepositoryTests 测试类，用于测试 MongoRepository 的增删改查操作。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MongoRepositoryTests</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="添加操作-1"><a href="#添加操作-1" class="headerlink" title="添加操作"></a>添加操作</h4><p>查询 MongoDB 数据库中 User 集合的数据。</p><img src="\img\mongodb\springmgdb114.png" style="zoom:33%;" /><p>在测试类中注入 UserRepository 接口，编写添加方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注入MongoRepository</span></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 添加操作</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">create</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">       user.setName(<span class="string">&quot;李渊&quot;</span>);</span><br><span class="line">       user.setAge(<span class="number">8</span>);</span><br><span class="line">       user.setEmail(<span class="string">&quot;618-626@qq.com&quot;</span>);</span><br><span class="line">       user.setCreateDate(<span class="string">&quot;566-635&quot;</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">u</span> <span class="operator">=</span> userRepository.save(user);</span><br><span class="line">       System.out.println(u);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb115.png" style="zoom:25%;" /><p>数据库的 User 集合：</p><img src="\img\mongodb\springmgdb116.png" style="zoom:33%;" /><h4 id="查询操作-1"><a href="#查询操作-1" class="headerlink" title="查询操作"></a>查询操作</h4><blockquote><p>查询User集合中的所有数据</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查询集合中所有记录</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findAll</span><span class="params">()</span> &#123;</span><br><span class="line">       List&lt;User&gt; users = userRepository.findAll();</span><br><span class="line">       users.forEach(System.out::println);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb117.png" style="zoom:25%;" /><blockquote><p>根据id查询</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据id查询集合中的记录</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findById</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userRepository.findById(<span class="string">&quot;62fc9de2468af469d5b44f30&quot;</span>).get();</span><br><span class="line">       System.out.println(user);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb118.png" style="zoom:25%;" /><blockquote><p>条件查询</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//条件查询：根据name和age查询</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findByNameAndAge</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">       user.setName(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">       user.setAge(<span class="number">27</span>);</span><br><span class="line">       Example&lt;User&gt; userExample = Example.of(user);</span><br><span class="line">       userRepository.findAll(userExample);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb119.png" style="zoom:25%;" /><blockquote><p>模糊查询</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模糊查询</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findLikeList</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//设置模糊查询的匹配规则</span></span><br><span class="line">       <span class="comment">/* ExampleMatcher.StringMatcher.CONTAINING：设置模糊查询 */</span></span><br><span class="line">       <span class="type">ExampleMatcher</span> <span class="variable">matcher</span> <span class="operator">=</span> ExampleMatcher.matching()</span><br><span class="line">               .withStringMatcher(ExampleMatcher.StringMatcher.CONTAINING)</span><br><span class="line">               .withIgnoreCase(<span class="literal">true</span>); <span class="comment">//忽略大小写</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">       user.setName(<span class="string">&quot;李&quot;</span>);</span><br><span class="line">       Example&lt;User&gt; userExample = Example.of(user,matcher);</span><br><span class="line">       List&lt;User&gt; users = userRepository.findAll(userExample);</span><br><span class="line">       System.out.println(users);</span><br><span class="line">       users.forEach(System.out::println);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb120.png" style="zoom:25%;" /><blockquote><p>分页查询</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分页查询</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">findPageUserList</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//设置分页的参数，0表示第一页</span></span><br><span class="line">       <span class="type">Pageable</span> <span class="variable">pageable</span> <span class="operator">=</span> PageRequest.of(<span class="number">0</span>,<span class="number">3</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">       user.setName(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">       Example&lt;User&gt; userExample = Example.of(user);</span><br><span class="line">       Page&lt;User&gt; page = userRepository.findAll(userExample, pageable);</span><br><span class="line">       System.out.println(page);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb121.png" style="zoom:25%;" /><p>添加断点，DBU查询 page 内的值。</p><img src="\img\mongodb\springmgdb122.png" style="zoom:25%;" /><h4 id="修改操作-1"><a href="#修改操作-1" class="headerlink" title="修改操作"></a>修改操作</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改操作</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//根据id查询</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userRepository.findById(<span class="string">&quot;62fc55c9687faf1ad2c15069&quot;</span>).get();</span><br><span class="line">       System.out.println(user);</span><br><span class="line">       <span class="comment">//设置修改值</span></span><br><span class="line">       user.setName(<span class="string">&quot;李世民&quot;</span>);</span><br><span class="line">       user.setAge(<span class="number">23</span>);</span><br><span class="line">       user.setEmail(<span class="string">&quot;626-649@qq.com&quot;</span>);</span><br><span class="line">       user.setCreateDate(<span class="string">&quot;599-649&quot;</span>);</span><br><span class="line">       <span class="type">User</span> <span class="variable">save</span> <span class="operator">=</span> userRepository.save(user);</span><br><span class="line">       System.out.println(save);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><img src="\img\mongodb\springmgdb123.png" style="zoom:25%;" /><h4 id="删除操作-1"><a href="#删除操作-1" class="headerlink" title="删除操作"></a>删除操作</h4><p>数据库数据查询：</p><img src="\img\mongodb\springmgdb124.png" style="zoom:33%;" /><p>在测试类中编写根据id删除数据的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除操作</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">       userRepository.deleteById(<span class="string">&quot;62fc4a4efe8af07497bb33a2&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>运行成功后，查询数据库数据的结果：</p><img src="\img\mongodb\springmgdb125.png" style="zoom: 33%;" />]]></content>
      
      
      <categories>
          
          <category> MongoDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MongoDB</title>
      <link href="/2022/08/16/MongoDB/"/>
      <url>/2022/08/16/MongoDB/</url>
      
        <content type="html"><![CDATA[<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><h4 id="NoSQL简介"><a href="#NoSQL简介" class="headerlink" title="NoSQL简介"></a>NoSQL简介</h4><p>NoSQL（Not Only SQL 的简称），意为反 SQL 运动，指的是非关系型的数据库，是一项全新的数据库革命性运动，早期就有人提出，发展至 2009 年趋势越发高涨。NoSQL 的拥护者们提倡运用非关系型的数据存储，相对于目前铺天盖地的关系型数据库运用，这一概念无疑是一种全新的思维的注入。</p><p>NoSQL的特点：</p><ul><li><p>对数据库高并发读写。</p></li><li><p>对海量数据的高效率存储和访问。</p></li><li><p>对数据库的高可扩展性和高可用性。</p></li></ul><p>NoSQL的弱点：</p><ul><li><p>数据库事务一致性需求</p></li><li><p>数据库的写实时性和读实时性需求</p></li><li><p>对复杂的SQL查询，特别是多表关联查询的需求</p></li></ul><h4 id="什么是MongoDB"><a href="#什么是MongoDB" class="headerlink" title="什么是MongoDB"></a>什么是MongoDB</h4><p>MongoDB 是由 C++ 语言编写的，是一个基于分布式文件存储的开源数据库系统。</p><p>在高负载的情况下，添加更多的节点，可以保证服务器性能。</p><p>MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。</p><p>MongoDB 将数据存储为一个文档，数据结构由键值(key&#x3D;&gt;value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p><h4 id="MongoDB-特点"><a href="#MongoDB-特点" class="headerlink" title="MongoDB 特点"></a>MongoDB 特点</h4><p>1、MongoDB 是一个面向文档存储的数据库，操作起来比较简单和容易。</p><p>2、你可以在MongoDB记录中设置任何属性的索引 (如：FirstName&#x3D;”Sameer”,Address&#x3D;”8 Gandhi Road”)来实现更快的排序。</p><p>3、你可以通过本地或者网络创建数据镜像，这使得MongoDB有更强的扩展性。</p><p>4、如果负载的增加（需要更多的存储空间和更强的处理能力） ，它可以分布在计算机网络中的其他节点上这就是所谓的分片。</p><p>5、Mongo支持丰富的查询表达式。查询指令使用JSON形式的标记，可轻易查询文档中内嵌的对象及数组。</p><p>6、MongoDb 使用update()命令可以实现替换完成的文档（数据）或者一些指定的数据字段 。</p><p>7、Mongodb中的Map&#x2F;reduce主要是用来对数据进行批量处理和聚合操作。</p><p>8、Map和Reduce。Map函数调用emit(key,value)遍历集合中所有的记录，将key与value传给Reduce函数进行处理。</p><p>9、Map函数和Reduce函数是使用Javascript编写的，并可以通过db.runCommand或mapreduce命令来执行MapReduce操作。</p><p>10、GridFS是MongoDB中的一个内置功能，可以用于存放大量小文件。</p><p>11、MongoDB允许在服务端执行脚本，可以用Javascript编写某个函数，直接在服务端执行，也可以把函数的定义存储在服务端，下次直接调用即可。</p><p>12、MongoDB支持各种编程语言:RUBY，PYTHON，JAVA，C++，PHP，C#等多种语言。</p><p>13、MongoDB安装简单。</p><h3 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h3><ul><li>拉取 mongodb 镜像</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mongo</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb01.png" style="zoom:38%;" /><ul><li>创建和启动容器</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --restart=always -p 27017:27017 --name mongodb -v /data/db:/data/db -d mongo</span><br></pre></td></tr></table></figure><blockquote><p>–restart&#x3D;always：当docker重启时，自动重启容器</p></blockquote><img src="\img\mongodb\mongodb02.png" style="zoom:38%;" /><ul><li>查询mongodb容器</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps </span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb03.png" style="zoom:38%;" /><blockquote><p>docker ps 是查询运行的容器，查询全部容器使用 docker ps -a</p></blockquote><ul><li>进入mongodb容器</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mongodb /bin/bash</span><br></pre></td></tr></table></figure><ul><li>进入mongodb控制台，对mongodb数据库进行操作</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb04.png" style="zoom:38%;" /><ul><li>查询所有的数据库</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show dbs</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb05.png" style="zoom:38%;" /><p>查出数据库，表示mongodb安装成功。</p><h3 id="基本概念与解析"><a href="#基本概念与解析" class="headerlink" title="基本概念与解析"></a>基本概念与解析</h3><p>在 mongodb 中基本的概念是文档、集合、数据库。详细见下表：</p><table><thead><tr><th>SQL术语&#x2F;概念</th><th>MongoDB术语&#x2F;概念</th><th>解释&#x2F;说明</th></tr></thead><tbody><tr><td>database</td><td>database</td><td>数据库</td></tr><tr><td>table</td><td>collection</td><td>数据库表&#x2F;集合</td></tr><tr><td>row</td><td>document</td><td>数据记录行&#x2F;文档</td></tr><tr><td>column</td><td>field</td><td>数据字段&#x2F;域</td></tr><tr><td>index</td><td>index</td><td>索引</td></tr><tr><td>table joins</td><td>&#x2F;</td><td>多表连接，MongoDB不支持</td></tr><tr><td>primary key</td><td>primary key</td><td>主键，MongoDB自动将 _id 字段设置为主键</td></tr></tbody></table><h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><p>一个mongodb中可以建立多个数据库</p><p>常用操作：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1、Help查看命令提示 </span><br><span class="line">db.help();</span><br><span class="line">2、切换/创建数据库</span><br><span class="line">use test</span><br><span class="line">如果数据库不存在，则创建数据库，否则切换到指定数据库</span><br><span class="line">3、查询所有数据库 </span><br><span class="line">show dbs;</span><br><span class="line">4、删除当前使用数据库 </span><br><span class="line">db.dropDatabase();</span><br><span class="line">5、查看当前使用的数据库 </span><br><span class="line">db.getName();</span><br><span class="line">6、显示当前db状态 </span><br><span class="line">db.stats();</span><br><span class="line">7、当前db版本 </span><br><span class="line">db.version();</span><br><span class="line">8、查看当前db的链接机器地址 </span><br><span class="line">db.getMongo〇;</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb06.png" style="zoom:38%;" /><blockquote><p>使用 use yygh 命令创建 yygh 数据库</p><p>使用 db.getName() 命令查询当前数据库名</p><p>注意：当数据库没有数据时，使用 show dbs 查询不了创建的数据库，只能查询系统自带的数据和有数据的数据库。</p></blockquote><h4 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h4><p>文档是一组键值（key-value）对（即 BSON）。MongoDB 的文档不需要设置相同的字段，并且相同的字段不需要相同的数据类型，这与关系型数据库有很大的区别，也是 MongoDB 非常突出的特点。</p><p>下表列出了 RDBMS 与 MongoDB 对应的术语：</p><table><thead><tr><th>RDBMS</th><th>MongoDB</th></tr></thead><tbody><tr><td>数据库</td><td>数据库</td></tr><tr><td>表格</td><td>集合</td></tr><tr><td>行</td><td>文档</td></tr><tr><td>列</td><td>字段</td></tr><tr><td>表联合</td><td>嵌入文档</td></tr><tr><td>主键</td><td>主键（MongoDB提供了 key 为 _id）</td></tr></tbody></table><p><strong>注意</strong>：</p><blockquote><p>1、文档中的键&#x2F;值对是有序的。</p><p>2、文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档)。</p><p>3、MongoDB区分类型和大小写。</p><p>4、MongoDB的文档不能有重复的键。</p><p>5、文档的键是字符串。除了少数例外情况，键可以使用任意UTF-8字符。</p></blockquote><p><strong>文档键命名规范</strong>：</p><blockquote><p>1、键不能含有 \0 (空字符)。这个字符用来表示键的结尾。</p><p>2、. 和 $ 有特别的意义，只有在特定环境下才能使用。</p><p>3、以下划线 “_” 开头的键是保留的(不是严格要求的)。</p></blockquote><h4 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h4><p>集合就是 MongoDB 文档组，类似于 RDBMS （关系数据库管理系统：Relational Database Management System)中的表格。</p><p>集合存在于数据库中，集合没有固定的结构，这意味着你在对集合可以插入不同格式和类型的数据，但通常情况下我们插入集合的数据都会有一定的关联性。</p><p>常用命令：</p><blockquote><p>1、 创建一个集合（table)</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection( &quot;collName&quot;);</span><br></pre></td></tr></table></figure><p>2、 得到指定名称的集合（table )</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getCollection(&quot;user&quot;);</span><br></pre></td></tr></table></figure></blockquote><img src="\img\mongodb\mongodb07.png" style="zoom:38%;" /><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><p>下表为MongoDB中常用的几种数据类型：</p><table><thead><tr><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>String</td><td>字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。</td></tr><tr><td>Integer</td><td>整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。</td></tr><tr><td>Boolean</td><td>布尔值。用于存储布尔值（真&#x2F;假）。</td></tr><tr><td>Double</td><td>双精度浮点值。用于存储浮点值。</td></tr><tr><td>Min&#x2F;Max keys</td><td>将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。</td></tr><tr><td>Arrays</td><td>用于将数组或列表或多个值存储为一个键。</td></tr><tr><td>Timestamp</td><td>时间戳。记录文档修改或添加的具体时间。</td></tr><tr><td>Object</td><td>用于内嵌文档。</td></tr><tr><td>Null</td><td>用于创建空值。</td></tr><tr><td>Symbol</td><td>符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。</td></tr><tr><td>Date</td><td>日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。</td></tr><tr><td>Object ID</td><td>对象 ID。用于创建文档的 ID。</td></tr><tr><td>Binary Data</td><td>二进制数据。用于存储二进制数据。</td></tr><tr><td>Code</td><td>代码类型。用于在文档中存储 JavaScript 代码。</td></tr><tr><td>Regular</td><td>正则表达式类型。用于存储正则表达式。</td></tr><tr><td>expression</td><td></td></tr></tbody></table><h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><ul><li><strong>适用场景</strong></li></ul><p>1、网站数据：Mongo非常适合实时的插入，更新与查询，并具备网站实时数据存储所需的复制及高度伸缩性。</p><p>2、缓存：由于性能很高，Mongo也适合作为信息基础设施的缓存层。在系统重启之后，由M ongo搭建的持久化缓存层可以避免下层的数据源过载。</p><p>3、大尺寸，低价值的数据：使用传统的关系型数据库存储一些数据时可能会比较昂贵， 在此之前，很多时候程序员往往会选择传统的文件进行存储。</p><p>4、高伸缩性的场景：Mongo非常适合由数十或数百台服务器组成的数据库。Mongo的路线图中已经包含对Map Reduce弓摩的内置支持。</p><p>5、用于对象及 JSON数据的存储：Mongo的BSON数据格式非常适合文档化格式的存储 及查询。</p><ul><li><strong>不适用场合</strong></li></ul><p>1、高度事务性的系统：例如银行或会计系统。传统的关系型数据库目前还是更适用于需要大量原子性复杂事务的应用程序。</p><p>2、传统的商业智能应用：针对特定问题的BI数据库会对产生高度优化的查询方式。对于此类应用，数据仓库可能是更合适的选择。</p><h3 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h3><h4 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h4><p>INSERT，添加操作。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#添加数据</span><br><span class="line">db.User.save(&#123;name:<span class="string">&#x27;zhangsan&#x27;</span>,age:<span class="number">21</span>,sex:<span class="literal">true</span>&#125;)</span><br><span class="line">#查询数据</span><br><span class="line">db.User.find()</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb08.png" style="zoom:38%;" /><p>_id组合</p><p>Objectld是 “_id” 的默认类型。Objectld 使用12字节的存储空间，每个字节二位十六进制数字， 是一个24位的字符串。</p><img src="\img\mongodb\mongodb09.png" style="zoom:50%;" /><ul><li><p>时间戳：时间不断变化的</p></li><li><p>机器：主机的唯_标识码。通常是机器主机名的散列值，这样可以确保不同主机生成不同的Objectld ，不产生冲突。</p></li><li><p>PID:为了确保在同一台机器上并发的多个进程产生的Objectld是唯一的，所以加上进程标识符(PID).</p></li><li><p>计数器：前9个字节保证了同一秒钟不同机器不同进程产生的 Objectld 是唯一的。 后3个字节就是一个自动增加的计数器，确保相同进程同一秒产生的 Objectld 也是 不一样。同一秒最多允许每个进程拥有 IS 777 2托个不同的 Objectld。</p></li></ul><h4 id="Query"><a href="#Query" class="headerlink" title="Query"></a>Query</h4><ul><li><p>WHERE（根据某个条件查询）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.User.find(&#123;name:&quot;李四&quot;&#125;)</span><br></pre></td></tr></table></figure><p>相当于MySQL的SQL语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>FIELDS（根据某个条件查询某条数据）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.User.find(&#123;age:<span class="number">21</span>&#125;, &#123;<span class="string">&#x27;name&#x27;</span>:<span class="number">1</span>, <span class="string">&#x27;age&#x27;</span>:<span class="number">1</span>&#125;)</span><br><span class="line">db.User.find(&#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;zhangsan&#x27;</span>&#125;, &#123;<span class="string">&#x27;name&#x27;</span>:<span class="number">1</span>, <span class="string">&#x27;age&#x27;</span>:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><p>相当于MySQL的SQL语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name, age <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">where</span> age <span class="operator">=</span> <span class="number">21</span></span><br><span class="line"><span class="keyword">select</span> name, age <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">where</span> name <span class="operator">=</span> zhangsan</span><br></pre></td></tr></table></figure></li></ul><img src="\img\mongodb\mongodb10.png" style="zoom:38%;" /><ul><li><p>SORT（排序）</p><p>在 MongoDB 中使用 sort() 方法对数据进行排序，sort() 方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中 1 为升序排列，而 -1 是用于降序排列。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">order</span> <span class="keyword">by</span> age</span><br><span class="line">db.User.find().sort(&#123;age:<span class="number">1</span>&#125;)</span><br><span class="line">db.User.find().sort(&#123;age:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb11.png" style="zoom:38%;" /></li><li><p>SUCE</p><p>在 MongoDB 中使用 limit()方法来读取指定数量的数据，skip() 方法来跳过指定数量的数据。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">skip</span> <span class="number">2</span> limit <span class="number">5</span></span><br><span class="line">db.User.find().<span class="keyword">skip</span>(<span class="number">0</span>).limit(<span class="number">5</span>)</span><br><span class="line">db.User.find().<span class="keyword">skip</span>(<span class="number">2</span>).limit(<span class="number">5</span>)</span><br></pre></td></tr></table></figure></li></ul><img src="\img\mongodb\mongodb12.png" style="zoom:38%;" /><ul><li><p>IN</p><p>查询某个范围内的数据。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">where</span> age <span class="keyword">in</span> (<span class="number">21</span>,<span class="number">18</span>)</span><br><span class="line"><span class="operator">&gt;</span> db.User.find(&#123;age:&#123;$<span class="keyword">in</span>:[<span class="number">21</span>,<span class="number">18</span>]&#125;&#125;)</span><br></pre></td></tr></table></figure></li><li><p>COUNT</p><p>查询某个范围内的数据条数。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">where</span> age <span class="operator">&gt;</span><span class="number">20</span></span><br><span class="line"><span class="operator">&gt;</span> db.User.find(&#123;age:&#123;$gt:<span class="number">20</span>&#125;&#125;).<span class="built_in">count</span>()</span><br></pre></td></tr></table></figure></li><li><p>OR</p><p>查询某个值到某个值之间的数据。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">User</span> <span class="keyword">where</span> age <span class="operator">=</span> <span class="number">21</span> <span class="keyword">or</span> age <span class="operator">=</span> <span class="number">28</span></span><br><span class="line"><span class="operator">&gt;</span> db.User.find(&#123;$<span class="keyword">or</span>:[&#123;age:<span class="number">21</span>&#125;, &#123;age:<span class="number">28</span>&#125;]&#125;)</span><br></pre></td></tr></table></figure></li></ul><img src="\img\mongodb\mongodb13.png" style="zoom:38%;" /><h4 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h4><p>可直接用类似 T-SQL 条件表达式更新，或用 Save() 更新从数据库返回到文档对象。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">update</span> <span class="keyword">User</span> <span class="keyword">set</span> age <span class="operator">=</span> <span class="number">100</span>, sex <span class="operator">=</span> <span class="number">0</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;user1&#x27;</span></span><br><span class="line">db.User.update(&#123;_id:<span class="string">&#x27;62fb00fc887e0e79c4a93a16&#x27;</span>&#125;, &#123;$<span class="keyword">set</span>:&#123;name:<span class="string">&#x27;张三&#x27;</span>,age:<span class="number">66</span>,sex:<span class="number">0</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb15.png" style="zoom:38%;" /><p>update() 方法的参数：</p><blockquote><p>语句：db.collection.update(criteria, objNew, upsert, mult)</p></blockquote><ul><li><p>collection：集合名（类似于MySQL的表名）</p></li><li><p>criteria：需要更新的条件表达式</p></li><li><p>objNew：更新表达式</p></li><li><p>upsert：如FI标记录不存在，是否插入新文档。 </p></li><li><p>multi：是否更新多个文档。</p></li></ul><h4 id="Remove"><a href="#Remove" class="headerlink" title="Remove"></a>Remove</h4><p>remove() 方法用于删除单个或全部文档，删除后的文档无法恢复。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.User.remove(id)#移除对应id的行</span><br><span class="line">db.User.remove(&#123;&#125;)#移除所有</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb16.png" style="zoom:38%;" /><h4 id="aggregate"><a href="#aggregate" class="headerlink" title="aggregate"></a>aggregate</h4><p>MongoDB中聚合(aggregate)主要用于处理数据(诸如统计平均值,求和等)，并返回计算后的数据结果。有点类似SQL语句中的 count(*)。</p><ul><li><strong>插入数据</strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">db.article.insert(&#123;</span><br><span class="line">    title: <span class="string">&#x27;MongoDB Overview&#x27;</span>, </span><br><span class="line">   description: <span class="string">&#x27;MongoDB is no sql database&#x27;</span>,</span><br><span class="line">   by_user: <span class="string">&#x27;runoob.com&#x27;</span>,</span><br><span class="line">   url: <span class="string">&#x27;http://www.runoob.com&#x27;</span>,</span><br><span class="line">   tags: [<span class="string">&#x27;mongodb&#x27;</span>, <span class="string">&#x27;database&#x27;</span>, <span class="string">&#x27;NoSQL&#x27;</span>],</span><br><span class="line">   likes: <span class="number">100</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">db.article.insert(&#123;</span><br><span class="line">   title: <span class="string">&#x27;NoSQL Overview&#x27;</span>, </span><br><span class="line">   description: <span class="string">&#x27;No sql database is very fast&#x27;</span>,</span><br><span class="line">   by_user: <span class="string">&#x27;runoob.com&#x27;</span>,</span><br><span class="line">   url: <span class="string">&#x27;http://www.runoob.com&#x27;</span>,</span><br><span class="line">   tags: [<span class="string">&#x27;mongodb&#x27;</span>, <span class="string">&#x27;database&#x27;</span>, <span class="string">&#x27;NoSQL&#x27;</span>],</span><br><span class="line">   likes: <span class="number">10</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">db.article.insert(&#123;</span><br><span class="line">   title: <span class="string">&#x27;Neo4j Overview&#x27;</span>, </span><br><span class="line">   description: <span class="string">&#x27;Neo4j is no sql database&#x27;</span>,</span><br><span class="line">   by_user: <span class="string">&#x27;Neo4j&#x27;</span>,</span><br><span class="line">   url: <span class="string">&#x27;http://www.neo4j.com&#x27;</span>,</span><br><span class="line">   tags: [<span class="string">&#x27;neo4j&#x27;</span>, <span class="string">&#x27;database&#x27;</span>, <span class="string">&#x27;NoSQL&#x27;</span>],</span><br><span class="line">   likes: <span class="number">750</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li><strong>统计sum</strong></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> by_user, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> article <span class="keyword">group</span> <span class="keyword">by</span> by_user</span><br><span class="line">db.article.aggregate([&#123;$<span class="keyword">group</span> : &#123;_id : &quot;$by_user&quot;, num_tutorial : &#123;$sum : <span class="number">1</span>&#125;&#125;&#125;])</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb17.png" style="zoom:38%;" /><p>在上面的例子中，我们通过字段 by_user 字段对数据进行分组，并计算 by_user 字段相同值的总和。</p><ul><li><strong>常见的聚合表达式</strong></li></ul><table><thead><tr><th>表达式</th><th>描述</th><th>实例</th></tr></thead><tbody><tr><td>$sum</td><td>计算总和</td><td>db.article.aggregate([{$group : {_id : “$by_user”, num_tutorial : {$sum : “$likes”}}}])</td></tr><tr><td>$avg</td><td>计算平均值</td><td>db.article.aggregate([{$group : {_id : “$by_user”, num_tutorial : {$avg : “$likes”}}}])</td></tr><tr><td>$min</td><td>获取集合中所有文档对应值的最小值</td><td>db.article.aggregate([{$group : {_id : “$by_user”, num_tutorial : {$min : “$likes”}}}])</td></tr><tr><td>$max</td><td>获取集合中所有文档对应值的最大值。</td><td>db.article.aggregate([{$group : {_id : “$by_user”, num_tutorial : {$max : “$likes”}}}])</td></tr><tr><td>$push</td><td>在结果文档中插入值到一个数组中。</td><td>db.article.aggregate([{$group : {_id : “$by_user”, url : {$push: “$url”}}}])</td></tr><tr><td>$addToSet</td><td>在结果文档中插入值到一个数组中，但不创建副本。</td><td>db.article.aggregate([{$group : {_id : “$by_user”, url : {$addToSet : “$url”}}}])</td></tr><tr><td>$first</td><td>根据资源文档的排序获取第一个文档数据。</td><td>db.article.aggregate([{$group : {_id : “$by_user”, first_url : {$first : “$url”}}}])</td></tr><tr><td>$last</td><td>根据资源文档的排序获取最后一个文档数据</td><td>db.article.aggregate([{$group : {_id : “$by_user”, last_url : {$last : “$url”}}}])</td></tr></tbody></table><img src="\img\mongodb\mongodb18.png" style="zoom:38%;" /><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><p>索引通常能够极大的提高查询的效率，如果没有索引，MongoDB在读取数据时必须扫描集合中的每个文件并选取那些符合查询条件的记录。</p><p>这种扫描全集合的查询效率是非常低的，特别在处理大量的数据时，查询可以要花费几十秒甚至几分钟，这对网站的性能是非常致命的。</p><p>索引是特殊的数据结构，索引存储在一个易于遍历读取的数据集合中，索引是对数据库表中一列或多列的值进行排序的一种结构。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.User.createIndex(&#123;&quot;name&quot;:<span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure><img src="\img\mongodb\mongodb19.png" style="zoom:38%;" /><p>语法中 name 值为你要创建的索引字段，1 为指定按升序创建索引，如果你想按降序来创建索引指定为 -1 即可。</p>]]></content>
      
      
      <categories>
          
          <category> MongoDB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MongoDB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis的核心配置文件</title>
      <link href="/2022/08/15/Mybatis%E7%9A%84%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
      <url>/2022/08/15/Mybatis%E7%9A%84%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>核心配置文件中的标签必须按照固定的顺序进行配置，配置顺序如下： </p><p>properties?, settings?, typeAliases?, typeHandlers?, objectFactory?, objectWrapperFactory?, reflectorFactory?, plugins?, environments?, databaseIdProvider?, mappers?</p></blockquote><h3 id="environments标签"><a href="#environments标签" class="headerlink" title="environments标签"></a>environments标签</h3><p>Mybatis 的核心配置文件：mybatis-config.xml。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">MyBatis核心配置文件中，标签的顺序：</span></span><br><span class="line"><span class="comment">properties?,settings?,typeAliases?,typeHandlers?,</span></span><br><span class="line"><span class="comment">objectFactory?,objectWrapperFactory?,reflectorFactory?,</span></span><br><span class="line"><span class="comment">plugins?,environments?,databaseIdProvider?,mappers?</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        environments：配置连接数据库的环境</span></span><br><span class="line"><span class="comment">            default属性：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            environment：设置一个具体的连接数据库的环境</span></span><br><span class="line"><span class="comment">                属性：①id，设置环境的唯一标识，不能重复</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                transactionManager：设置事务管理器</span></span><br><span class="line"><span class="comment">                    属性：①type，设置事务管理的方式。type=&quot;JDBC|MANAGED&quot;。</span></span><br><span class="line"><span class="comment">                           JDBC：表示使用JDBC原生的事务管理方式；</span></span><br><span class="line"><span class="comment">                           MANAGED：被管理，例如交给Spring管理。</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                dataSource：设置数据源</span></span><br><span class="line"><span class="comment">                    属性：①type，设置数据源的类型。type=&quot;POOLED|UNPOOLED|JNDI&quot;。</span></span><br><span class="line"><span class="comment">                            POOLED：表示使用数据库连接池；</span></span><br><span class="line"><span class="comment">                            UNPOOLED：表示不使用数据库连接池；</span></span><br><span class="line"><span class="comment">                            JNDI：表示使用上下文中的数据源。</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入mybatis映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="properties标签"><a href="#properties标签" class="headerlink" title="properties标签"></a>properties标签</h3><blockquote><p>由上面可知，连接数据库的参数写在核心配置类内部，不便宜修改，所以将其提取处理，放在单独文件（即 <code>jdbc.properties</code>）内，以便管理。</p></blockquote><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure><p>在核心配置文件中，添加 <code>properties</code> 标签，通过 <code>resource</code> 属性引入 <code>jdbc.properties</code> 文件；在通过 <code>property</code> 标签的 <code>value</code> 属性使用 ${key} 的方式，获取 jdbc.properties 文件中的 value 值。</p><p>修改后的 mybatis-congif.xml 文件：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        MyBatis核心配置文件中，标签的顺序：</span></span><br><span class="line"><span class="comment">            properties?,settings?,typeAliases?,typeHandlers?,objectFactory?,</span></span><br><span class="line"><span class="comment">            objectWrapperFactory?,reflectorFactory?,plugins?,environments?,</span></span><br><span class="line"><span class="comment">            databaseIdProvider?,mappers?</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入properties文件，此后就可以在当前文件中使用$&#123;key&#125;的方式访问value值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        environments：配置连接数据库的环境</span></span><br><span class="line"><span class="comment">            属性：</span></span><br><span class="line"><span class="comment">                default：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">            environment：设置一个具体的连接数据库的环境</span></span><br><span class="line"><span class="comment">                属性：</span></span><br><span class="line"><span class="comment">                    id：设置环境的唯一标识，不能重复</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                transactionManager：设置事务管理器</span></span><br><span class="line"><span class="comment">                    属性：</span></span><br><span class="line"><span class="comment">                        type：设置事务管理的方式，type=&quot;JDBC|MANAGED&quot;。</span></span><br><span class="line"><span class="comment">                           JDBC：表示使用JDBC原生的事务管理方式；</span></span><br><span class="line"><span class="comment">                           MANAGED：被管理，例如交给Spring管理。</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                dataSource：设置数据源</span></span><br><span class="line"><span class="comment">                    属性：</span></span><br><span class="line"><span class="comment">                        type：设置数据源的类型，type=&quot;POOLED|UNPOOLED|JNDI&quot;。</span></span><br><span class="line"><span class="comment">                            POOLED：表示使用数据库连接池；</span></span><br><span class="line"><span class="comment">                            UNPOOLED：表示不使用数据库连接池；</span></span><br><span class="line"><span class="comment">                            JNDI：表示使用上下文中的数据源。</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的驱动--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的连接地址--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的用户名--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的密码--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入mybatis映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>重新启动<strong>查询所有用户信息</strong>的方法</p></blockquote><img src="\img\Mybatis\mybatis16.png" style="zoom:25%;" /><h3 id="typeAliases标签"><a href="#typeAliases标签" class="headerlink" title="typeAliases标签"></a>typeAliases标签</h3><p><code>typeAliases</code> 设置别名，其配置顺序在 <code>properties</code> 标签和 <code>settings</code> 标签之后。设置别名的方式共有三种，三种方式讲解见下方，第三种方式常用。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">       typeAliases：设置类型别名，即为某一具体的类型设置一个别名</span></span><br><span class="line"><span class="comment">           在Mybatis的范围中，就可以使用别名表示一个具体的类型</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 设置别名的方式一</span></span><br><span class="line"><span class="comment">               type和alias属性都设置有值时。</span></span><br><span class="line"><span class="comment">               type：表示设置需要起别名的类型，alias：表示设置某个类型的别名</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.mybatis.pojo.User&quot; alias=&quot;u&quot;/&gt;--&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 设置别名的方式二</span></span><br><span class="line"><span class="comment">               只设置type而不设置alias时，当前的类型默认别名为类名且不区分大小写</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.mybatis.pojo.User&quot;/&gt;--&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">           设置别名的方式三</span></span><br><span class="line"><span class="comment">               通过包的方式设置别名，指定包下的所有的类将全部拥有默认别名</span></span><br><span class="line"><span class="comment">                   默认别名，即类名且不区分大小写</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.mybatis.pojo&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="mappers标签"><a href="#mappers标签" class="headerlink" title="mappers标签"></a>mappers标签</h3><p><code>mappers</code> 引入mapper映射文件，其配置顺序在最末尾。引入映射文件的方式有两种，两种方式如下文，第二种最常用。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入mybatis映射文件--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">           方式一</span></span><br><span class="line"><span class="comment">               通过resource属性设置mapper映射文件的路径</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--&lt;mapper resource=&quot;mapper/UserMapper.xml&quot;/&gt;--&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">           方式二（常用）</span></span><br><span class="line"><span class="comment">               以包的方式引入映射文件，但必须满足两个条件：</span></span><br><span class="line"><span class="comment">                   1、mapper接口和映射文件所在的包必须一致；</span></span><br><span class="line"><span class="comment">                   2、mapper接口的名字和映射文件的名字必须一致。</span></span><br><span class="line"><span class="comment">       --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.mybatis.&quot;</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：在使用 IDEA 工具创建包时，在工程项目中的其他目录下可以使用点（.）的方式创建多个包，但是在 <code>resource</code> 包下不能使用点的方式创建，要使用斜杠（&#x2F;）的方式进行创建多个包。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Mybatis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis入门案例</title>
      <link href="/2022/08/11/Mybatis%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B/"/>
      <url>/2022/08/11/Mybatis%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="创建mybatis数据库"><a href="#创建mybatis数据库" class="headerlink" title="创建mybatis数据库"></a>创建mybatis数据库</h3><p>使用 Navicat 工具创建新的数据库。</p><img src="\img\Mybatis\mybatis01.png" style="zoom:50%;" /><p>新数据库的数据库名为<code>mabatis</code>，字符集为<code>utf8mb4</code>，排序规矩为<code>utf8mb4_bin</code>。</p><img src="\img\Mybatis\mybatis02.png" style="zoom: 50%;" /><h3 id="创建user表"><a href="#创建user表" class="headerlink" title="创建user表"></a>创建user表</h3><p>使用下面代码通过查询方式创建数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_user`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_user`  (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">int</span>(<span class="number">0</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `gender` <span class="type">char</span>(<span class="number">1</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br></pre></td></tr></table></figure><blockquote><p>AUTO_INCREMENT：自增约束</p><p>CHARACTER SET：字符集编码</p><p>COLLATE：</p></blockquote><img src="\img\Mybatis\mybatis03.png" style="zoom: 33%;" /><h3 id="创建maven项目"><a href="#创建maven项目" class="headerlink" title="创建maven项目"></a>创建maven项目</h3><p>新建工程。</p><img src="\img\Mybatis\mybatis04.png" style="zoom: 33%;" /><p>选择maven工程，本地使用的maven版本为<code>3.6.3</code>。</p><img src="\img\Mybatis\mybatis05.png" style="zoom:33%;" /><p>工程的项目名为Mybatis。</p><img src="\img\Mybatis\mybatis06.png" style="zoom:33%;" /><h3 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h3><p>在Mybatis工程的pom.xml的文件添加相关依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置项目打包方式--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Mybatis核心 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- junit测试 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建实体类"><a href="#创建实体类" class="headerlink" title="创建实体类"></a>创建实体类</h3><p>在 java 包下新建 <code>com.mybatis.pojo</code> 包，在 pojo 包下创建 User 类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这里省略getter/setter方法和有参/无参方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建mapper接口"><a href="#创建mapper接口" class="headerlink" title="创建mapper接口"></a>创建mapper接口</h3><p>创建存放 mapper 接口的包：<code>com.mybatis.mapper</code>。在 mapper 包下创建 UserMapper 类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">  <span class="comment">//mapper方法  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建mapper映射文件"><a href="#创建mapper映射文件" class="headerlink" title="创建mapper映射文件"></a>创建mapper映射文件</h3><p>在 resources 包下，创建存放 mapper 映射文件的包<code>mapper</code>，在 mapper 下创建 UserMapper.xml 映射文件。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mapper接口和映射文件要保证两个一致：</span></span><br><span class="line"><span class="comment">        1、mapper接口的全类名和映射文件的namespace一致</span></span><br><span class="line"><span class="comment">        2、mapper接口中的方法的方法名要和映射文件中的sql的id保持一致</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.mybatis.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 实现mapper接口的sql语句 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建mybatis核心配置文件"><a href="#创建mybatis核心配置文件" class="headerlink" title="创建mybatis核心配置文件"></a>创建mybatis核心配置文件</h3><p>在 resources 包下，创建mybatis核心配置文件：mybatis-config.xml。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置连接数据库的环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--transactionManager：事务管理器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--dataSource：数据源--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入mybatis映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mapper/UserMapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="新增用户信息"><a href="#新增用户信息" class="headerlink" title="新增用户信息"></a>新增用户信息</h3><blockquote><p>在 UserMapper 类添加新增用户信息代码：</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 新增用户信息 */</span></span><br><span class="line">   <span class="type">int</span> <span class="title function_">insertUser</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>在 UserMapper.xml 映射文件添加新增用户信息代码：</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- int insertUser(); --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">       insert into t_user value(null,&#x27;王二&#x27;,&#x27;123456&#x27;,20,&#x27;男&#x27;,&#x27;123@qq.com&#x27;)</span><br><span class="line">   <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>编写测试类</p></blockquote><p>在 test&#x2F;java 包下创建存放测试类的包：com.mybatis.test。创建 MybatisTest 测试类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增用户信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertUser</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//1.获取Mybatis核心配置文件的输入流</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//2.获取SqlSessionFactoryBuilder对象</span></span><br><span class="line">        <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">        <span class="comment">//3.获取SqlSessionFactory对象</span></span><br><span class="line">        <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(inputStream);</span><br><span class="line">        <span class="comment">//4.①获取sql的会话对象SqlSession（该写法不会自动提交事务），是MyBatis提供的操作数据库的对象</span></span><br><span class="line">        <span class="comment">//SqlSession sqlSession = sqlSessionFactory.openSession();</span></span><br><span class="line">        <span class="comment">//4.②获取sql的会话对象SqlSession（该写法会自动提交事务），是MyBatis提供的操作数据库的对象</span></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">/*5.面向mapper接口编程（常用写法） */</span></span><br><span class="line">        <span class="comment">/*实现思想：通过mapper接口的全类名，找到mapper接口的映射文件；</span></span><br><span class="line"><span class="comment">            然后通过mapper接口的方法，找到mapper映射文件中的sql语句并执行*/</span></span><br><span class="line">        <span class="comment">//①.获取UserMapper的代理实现类对象</span></span><br><span class="line">        <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        <span class="comment">//②.调用mapper接口中的方法，实现添加用户信息的功能</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> mapper.insertUser();</span><br><span class="line">        <span class="comment">/* 没有mapper接口的情况下 */</span></span><br><span class="line">        <span class="comment">//通过sql语句的唯一标识，找到sql语句并执行。唯一标识是namespace.sqlId（最原始的写法）</span></span><br><span class="line">        <span class="comment">//int result = sqlSession.insert(&quot;com.mybatis.mapper.UserMapper.insertUser&quot;);</span></span><br><span class="line">        System.out.println(<span class="string">&quot;结果：&quot;</span>+result);</span><br><span class="line">        <span class="comment">//6.提交事务（第四步没有提交事务的话，这里要将事务提交）</span></span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        <span class="comment">//7.关闭事务</span></span><br><span class="line">        sqlSession.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>测试结果</p></blockquote><img src="\img\Mybatis\mybatis07.png" style="zoom: 25%;" /><blockquote><p>数据库 user 表</p></blockquote><img src="\img\Mybatis\mybatis08.png" style="zoom:33%;" /><h3 id="封装SqlSesson类"><a href="#封装SqlSesson类" class="headerlink" title="封装SqlSesson类"></a>封装SqlSesson类</h3><p>操作 t_user 表时（即CRUD），频繁最开始都是要获取sqlSession，且获取该方法的步骤都是一样的，所以将其封装成一个类，以便使用和管理。</p><p>在java包下创建存放获取sqlSession类（即SqlSessionUtil）的工具类的地址：<code>com.mybatis.utils</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlSessionUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 因获取sqlSession的方法步骤固定，且频繁使用，所以将其封装起来，以便使用</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title function_">getSqlSession</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.获取Mybatis核心配置文件的输入流</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            <span class="comment">//2.获取SqlSessionFactoryBuilder对象</span></span><br><span class="line">            <span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line">            <span class="comment">//3.获取SqlSessionFactory对象</span></span><br><span class="line">            <span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(inputStream);</span><br><span class="line">            <span class="comment">//4.获取sql的会话对象SqlSession（自动提交事务：在openSession方法中参数true），是MyBatis提供的操作数据库的对象</span></span><br><span class="line">            sqlSession = sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sqlSession;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="查询所有用户信息"><a href="#查询所有用户信息" class="headerlink" title="查询所有用户信息"></a>查询所有用户信息</h3><blockquote><p>在 UserMapper 接口中添加查询所有用户信息的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 查询所有用户信息 */</span></span><br><span class="line">   List&lt;User&gt; <span class="title function_">getAllUser</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>在 UserMapper.xml 映射文件中添加实现查询所有用户信息的方法。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- List&lt;User&gt; getAllUser(); --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.mybatis.pojo.User&quot;</span>&gt;</span></span><br><span class="line">       select * from t_user</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>在 MybatisTest 测试类中编写查询所有用户信息的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getAllUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//1.通过SqlSessionUtil工具类获取sqlSession</span></span><br><span class="line">       <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtil.getSqlSession();</span><br><span class="line">       <span class="comment">//2.获取UserMapper的代理实现类对象</span></span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       <span class="comment">//3.调用mapper接口中的方法，实现查询所有用户信息的功能</span></span><br><span class="line">       List&lt;User&gt; allUser = mapper.getAllUser();</span><br><span class="line">       <span class="comment">//4.将查询到的用户信息输出在控制台中</span></span><br><span class="line">       allUser.forEach(System.out::println);</span><br><span class="line">       <span class="comment">//5.关闭事务</span></span><br><span class="line">       sqlSession.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><blockquote><p>查询结果</p></blockquote><img src="\img\Mybatis\mybatis09.png" style="zoom: 25%;" /><h3 id="根据id查询用户信息"><a href="#根据id查询用户信息" class="headerlink" title="根据id查询用户信息"></a>根据id查询用户信息</h3><blockquote><p>在 UserMapper 接口中添加<strong>根据id查询用户信息</strong>的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 根据id查询用户信息 */</span></span><br><span class="line">   User <span class="title function_">getUserById</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>在 UserMapper.xml 映射文件中添加实现<strong>根据id查询用户信息</strong>的方法。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- List&lt;User&gt; getAllUser(); --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.mybatis.pojo.User&quot;</span>&gt;</span></span><br><span class="line">       select * from t_user where id=3</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>在 MybatisTest 测试类中编写<strong>根据id查询用户信息</strong>的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUserById</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//1.通过SqlSessionUtil工具类获取sqlSession</span></span><br><span class="line">       <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtil.getSqlSession();</span><br><span class="line">       <span class="comment">//2.获取UserMapper的代理实现类对象</span></span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       <span class="comment">//3.调用mapper接口中的方法，实现根据id查询用户信息的功能</span></span><br><span class="line">       <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mapper.getUserById();</span><br><span class="line">       <span class="comment">//4.将查询到的用户信息输出在控制台中</span></span><br><span class="line">       System.out.println(user);</span><br><span class="line">       <span class="comment">//5.关闭事务</span></span><br><span class="line">       sqlSession.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><blockquote><p>查询结果</p></blockquote><img src="\img\Mybatis\mybatis10.png" style="zoom:25%;" /><h3 id="修改用户信息"><a href="#修改用户信息" class="headerlink" title="修改用户信息"></a>修改用户信息</h3><blockquote><p>在 UserMapper 接口中添加<strong>修改用户信息</strong>的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 根据id查询用户信息 */</span></span><br><span class="line">   User <span class="title function_">getUserById</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>在 UserMapper.xml 映射文件中添加实现<strong>修改用户信息</strong>的方法。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- void updateUser(); --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span>&gt;</span></span><br><span class="line">       update t_user set username=&#x27;李四&#x27;,password=&#x27;4444&#x27; where id=4</span><br><span class="line">   <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>在 MybatisTest 测试类中编写<strong>修改用户信息</strong>的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//1.通过SqlSessionUtil工具类获取sqlSession</span></span><br><span class="line">       <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtil.getSqlSession();</span><br><span class="line">       <span class="comment">//2.获取UserMapper的代理实现类对象</span></span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       <span class="comment">//3.调用mapper接口中的方法，实现修改用户信息的功能</span></span><br><span class="line">       mapper.updateUser();</span><br><span class="line">       <span class="comment">//4.关闭事务</span></span><br><span class="line">       sqlSession.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><blockquote><p>查询结果</p></blockquote><img src="\img\Mybatis\mybatis11.png" style="zoom: 33%;" /><h3 id="删除用户信息"><a href="#删除用户信息" class="headerlink" title="删除用户信息"></a>删除用户信息</h3><blockquote><p>在 UserMapper 接口中添加<strong>删除用户信息</strong>的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 删除用户信息 */</span></span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><blockquote><p>在 UserMapper.xml 映射文件中添加实现<strong>删除用户信息</strong>的方法。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- void deleteUser(); --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span>&gt;</span></span><br><span class="line">       delete from t_user where id=4</span><br><span class="line">   <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>在 MybatisTest 测试类中编写<strong>删除用户信息</strong>的方法。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">//1.通过SqlSessionUtil工具类获取sqlSession</span></span><br><span class="line">       <span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> SqlSessionUtil.getSqlSession();</span><br><span class="line">       <span class="comment">//2.获取UserMapper的代理实现类对象</span></span><br><span class="line">       <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line">       <span class="comment">//3.调用mapper接口中的方法，实现修改用户信息的功能</span></span><br><span class="line">       mapper.deleteUser();</span><br><span class="line">       <span class="comment">//4.关闭事务</span></span><br><span class="line">       sqlSession.close();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><blockquote><p>查询结果</p></blockquote><img src="\img\Mybatis\mybatis12.png" style="zoom:33%;" />]]></content>
      
      
      <categories>
          
          <category> Mybatis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker安装（Linux）</title>
      <link href="/2022/08/01/Docker%E5%AE%89%E8%A3%85%EF%BC%88Linux%EF%BC%89/"/>
      <url>/2022/08/01/Docker%E5%AE%89%E8%A3%85%EF%BC%88Linux%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p><strong>第 1 步</strong>：将 yum 包更新到最新，更新过程中出现输入的界面都输入 y 。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令：yum update</span><br><span class="line">出现 Complete! 表示更新完成</span><br></pre></td></tr></table></figure><img src="\img\docker\docker01.png" style="zoom: 33%;" /><p><strong>第 2 步：</strong>安装需要的软件包（ yum-utils、device-mapper-persistent-data、lvm2），yum-util 提供 yum-config-manager 功能，另外两个是 devicemapper 驱动依赖。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令：yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure><img src="\img\docker\docker02.png" style="zoom:33%;" /><p><strong>第 3 步：</strong>设置 yum 源。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令：yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure><img src="\img\docker\docker03.png" style="zoom:33%;" /><p><strong>第 4 步：</strong>安装 docker，出现输入的界面都输入 y。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">命令：yum install -y docker-ce</span><br><span class="line"></span><br><span class="line">出现 Complete! 表示安装成功</span><br></pre></td></tr></table></figure><img src="\img\docker\docker04.png" style="zoom:33%;" /><p><strong>第 5 步：</strong>查看 docker 版本，验证是否安装成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">命令：docker -v</span><br></pre></td></tr></table></figure><img src="\img\docker\docker05.png" style="zoom:33%;" />]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VMWare创建虚拟机</title>
      <link href="/2022/08/01/VMWare%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
      <url>/2022/08/01/VMWare%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<h3 id="虚拟机创建"><a href="#虚拟机创建" class="headerlink" title="虚拟机创建"></a>虚拟机创建</h3><p><strong>第 1 步</strong>：点击主页下的创建新的虚拟机。</p><img src="/img/vmware/01.png" style="zoom:33%;" /><p><strong>第 2 步</strong>：自定义配置</p><img src="/img/vmware/02.png" style="zoom: 50%;" /><p><strong>第 3 步</strong>：默认选择即可。</p><img src="\img\vmware\03.png" style="zoom: 50%;" /><p><strong>第 4 步</strong>：选择安装来源，我是安装完之后，在导入下载好的操作系统，这里选择<strong>稍后安装操作系统</strong>。</p><img src="\img\vmware\04.png" style="zoom:50%;" /><p><strong>第 5 步</strong>：选择 <strong>Linux</strong> 操作系统，版本选 CentOS 64 位，后续导入的操作系统为CentOS 7。</p><img src="\img\vmware\05.png" style="zoom:50%;" /><p><strong>第 6 步</strong>：虚拟机的名称和安装位置自定义。</p><img src="\img\vmware\06.png" style="zoom:50%;" /><p><strong>第 7 步</strong>：配置处理器：处理器数量和每个处理器的核心数量都选为 2 个，总核数为4。</p><img src="\img\vmware\07.png" style="zoom:50%;" /><p><strong>第 8 步</strong>：虚拟机内存配置：选择 4 GB。</p><img src="\img\vmware\08.png" style="zoom:50%;" /><p><strong>第 9 步</strong>：网络类型配置：网络连接方式选择使用网络地址转换</p><img src="\img\vmware\09.png" style="zoom:50%;" /><p><strong>第 10 步</strong>：I&#x2F;O控制器类型配置：选择 LSI Login。</p><img src="\img\vmware\10.png" style="zoom:50%;" /><p><strong>第 11 步</strong>：磁盘类型配置：使用推荐（默认）即可。</p><img src="\img\vmware\11.png" style="zoom:50%;" /><p><strong>第 12 步</strong>：磁盘配置：</p><ul><li>创建新虚拟磁盘</li></ul><img src="\img\vmware\12.png" style="zoom:50%;" /><ul><li>磁盘容量：20GB，将虚拟磁盘拆分成多个文件</li></ul><img src="\img\vmware\13.png" style="zoom:50%;" /><ul><li>磁盘文件：默认即可</li></ul><img src="\img\vmware\14.png" style="zoom:50%;" /><p><strong>第 13 步</strong>： 将不需要的硬件将其移除。</p><img src="\img\vmware\15.png" style="zoom: 33%;" /><p><strong>第 14 步</strong>：至此，虚拟机创建成功，下面是配置虚拟机的操作系统。</p><img src="\img\vmware\16.png" style="zoom:33%;" /><h3 id="虚拟机配置"><a href="#虚拟机配置" class="headerlink" title="虚拟机配置"></a>虚拟机配置</h3><p><strong>第 1步</strong>：导入映射 CentOS 7 系统镜像文件。</p><img src="\img\vmware\17.png" style="zoom: 25%;" /><p><strong>第 2 步</strong>：启动虚拟机，安装 CentOS 7 系统。白色字体表示选中状态。选中 Install CentOS 7，点击 Enter 安装 CentOS 7 操作系统。</p><img src="\img\vmware\18.png" style="zoom: 50%;" /><p><strong>第 3 步</strong>：正在安装中。</p><img src="\img\vmware\19.png" style="zoom: 50%;" /><p><strong>第 4 步</strong>：语言配置，这里选择 English</p><img src="\img\vmware\20.png" style="zoom:50%;" /><p><strong>第 5 步</strong>：日期和时间的配置，时区选择亚洲·上海。</p><img src="\img\vmware\21.png" style="zoom:50%;" /><p><strong>第 6 步</strong>：多语言选择，另一个语言这里选择简体中文。</p><img src="\img\vmware\22.png" style="zoom:50%;" /><p><strong>第 7 步</strong>：SOFTWARE SELECTION（软件选择），选择 <code>Service with GUI </code>。</p><img src="\img\vmware\23.png" style="zoom: 50%;" /><p><strong>第 8 步</strong>：INSTALLATION DESTINATION（磁盘安装配置）</p><img src="\img\vmware\24.png" style="zoom:50%;" /><ul><li>分盘，将 20GB 内存的容量分配到三个目录中，即 &#x2F;boot、&#x2F;、swap。<ul><li>分配 &#x2F;boot</li></ul></li></ul><img src="\img\vmware\25.png" style="zoom:50%;" /><ul><li>按照创建 &#x2F;boot 的步骤，创建其他两个目录（即 &#x2F; 和 swap）大小。</li></ul><img src="\img\vmware\26.png" style="zoom:50%;" /><ul><li>配置完成之后，点击 Done ，弹出框选择 <strong>Accept Changes</strong></li></ul><img src="\img\vmware\27.png" style="zoom:50%;" /><p><strong>第 9 步</strong>：NETWORK &amp; HOST NAME（网络与主机名）配置，将 Ethernet 置为 ON 状态。</p><img src="\img\vmware\28.png" style="zoom:50%;" /><p><strong>第 10 步</strong>：点击 Begin Installated ，继续安装操作系统</p><img src="\img\vmware\29.png" style="zoom:50%;" /><p><strong>第 11 步</strong>：登录用户配置。</p><img src="\img\vmware\30.png" style="zoom:50%;" /><ul><li><p>root账号配置</p><p>用户名默认为 root，只需要配置密码即可，密码一般为8个字符以上，且包含大小字母和数字，密码设置简单也没事，点击两次 Done 即可。（这里密码设为root）</p></li></ul><img src="\img\vmware\31.png" style="zoom:50%;" /><ul><li><p>普通用户配置</p><p>普通用户需要设置用户名和密码，密码设置规则同上。用户名随意即可。</p></li></ul><img src="\img\vmware\32.png" style="zoom:50%;" /><p><strong>第 12 步</strong>：安装完成</p><img src="\img\vmware\33.png" style="zoom:50%;" /><p><strong>第 13 步</strong>：初步进入系统，同意即可。输入1，输入 c ，输入 2 ，输入 1应该可以进入系统中。</p><img src="\img\vmware\34.png" style="zoom: 33%;" /><p><strong>第 14 步</strong>：进入系统中，默认登录账号为普通用户。</p><p>需要登录root账号，点击 Not listed？输入用户名和密码即可</p><img src="\img\vmware\35.png" style="zoom:33%;" /><p><strong>第 15 步</strong>：首次进入 Linux 系统，会弹出很多弹出框，选择下一步默认即可，不需要特殊配置。</p><img src="\img\vmware\36.png" style="zoom: 33%;" /><p><strong>第 16 步</strong>：进入 Lunix 系统界面，表示安装成功。</p><img src="\img\vmware\37.png" style="zoom: 33%;" /><p><strong>第 17 步</strong>：右击界面，选择 Open Terminal，弹出命令行窗口，输入 <code>ip addr</code>  指令，查询虚拟机的IP地址。</p><img src="\img\vmware\38.png" style="zoom: 50%;" />]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VMWare </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>反向生成器的配置</title>
      <link href="/2022/07/17/%E5%8F%8D%E5%90%91%E7%94%9F%E6%88%90%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE/"/>
      <url>/2022/07/17/%E5%8F%8D%E5%90%91%E7%94%9F%E6%88%90%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="反向生成器的配置"><a href="#反向生成器的配置" class="headerlink" title="反向生成器的配置"></a>反向生成器的配置</h3><blockquote><p>使用 MyBatis 的反向生成器，自动生成用户的实体类 、接口和 <code>xml</code> 文件。</p></blockquote><p>在 pom.xml 文件中添加反向生成器插件的依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                 <span class="comment">&lt;!--配置文件的路径--&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><p>位置如图所示：</p><img src="/img/hospital/17.png" style="zoom: 33%;" /><p>在 resources 目录下创建 generatorConfig.xml 文件。</p><img src="/img/hospital/18.png" style="zoom: 50%;" /><p>文件代码：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置生成器:所有标有序号的内容都需要修改为自己的内容或者路径 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--1、数据库驱动jar:添加自己的jar路径 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">classPathEntry</span></span></span><br><span class="line"><span class="tag">            <span class="attr">location</span>=<span class="string">&quot;D:\repository\mysql\mysql-connector-java\8.0.23\mysql-connector-java-8.0.23.jar&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;MyBatis&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--去除注释 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suppressAllComments&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--2、数据库连接 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://127.0.0.1:3306/hospital?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf-8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=GMT&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">password</span>=<span class="string">&quot;123456&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为 Integer;</span></span><br><span class="line"><span class="comment">            为 true时把JDBC DECIMAL和NUMERIC类型解析为java.math.BigDecimal --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;forceBigDecimals&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--3、生成实体类 指定包名 以及生成的地址 （可以自定义地址，但是路径不存在不会自动创建</span></span><br><span class="line"><span class="comment">        使用Maven生成在target目录下，会自动创建） --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.hospital.pojo&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">targetProject</span>=<span class="string">&quot;src\main\java&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;trimStrings&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--4、生成SQLmapper.xml文件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.hospital.mapper&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">targetProject</span>=<span class="string">&quot;src\main\resources&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--5、生成Dao（Mapper）文件,生成接口 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">targetPackage</span>=<span class="string">&quot;com.hospital.mapper&quot;</span></span></span><br><span class="line"><span class="tag">                             <span class="attr">targetProject</span>=<span class="string">&quot;src\main\java&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--6、要生成哪些表(更改tableName和domainObjectName就可以) --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- tableName:要生成的表名</span></span><br><span class="line"><span class="comment">        enableCountByExample:Count语句中加入where条件查询，默认为true开启</span></span><br><span class="line"><span class="comment">        enableUpdateByExample:Update语句中加入where条件查询，默认为true开启</span></span><br><span class="line"><span class="comment">        enableDeleteByExample:Delete语句中加入where条件查询，默认为true开启</span></span><br><span class="line"><span class="comment">        enableSelectByExample:Select多条语句中加入where条件查询，默认为true开启</span></span><br><span class="line"><span class="comment">        selectByExampleQueryId:Select单个对象语句中加入where条件查询，默认为true开启</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;hospital_user&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;role&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;menu&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;role_menu&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;doctor&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;charge_project&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;drug&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;register&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;be_hospital&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;drug_people&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;price_people&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>配置完成之后，找到 Maven 下的 mybatis-generator 依赖下的 mybatis-generator:generate，点击运气即可。</p><img src="/img/hospital/19.png" style="zoom: 33%;" /><p>完成操作之后，项目中的实体类文件、mapper文件、xml文件就自动生成，如图所示。</p><img src="/img/hospital/21.png" style="zoom: 33%;" />]]></content>
      
      
      <categories>
          
          <category> 医院项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 医院项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>医院项目数据库设计</title>
      <link href="/2022/07/17/%E5%8C%BB%E9%99%A2%E9%A1%B9%E7%9B%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/"/>
      <url>/2022/07/17/%E5%8C%BB%E9%99%A2%E9%A1%B9%E7%9B%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h2 id="医院项目数据库设计"><a href="#医院项目数据库设计" class="headerlink" title="医院项目数据库设计"></a>医院项目数据库设计</h2><blockquote><p>默认数据库已经创建</p></blockquote><h3 id="用户表"><a href="#用户表" class="headerlink" title="用户表"></a>用户表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `hospital_user`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `hospital_user` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `login_name`<span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;登录名&#x27;</span>,</span><br><span class="line">    `password`      <span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">    `true_name` <span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;真实姓名&#x27;</span>,</span><br><span class="line">    `email`         <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">    `state`    <span class="type">INT</span>  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户状态，1 禁用，0 正常&#x27;</span>,</span><br><span class="line">    `role_id`       <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;角色编号&#x27;</span>,</span><br><span class="line">    `deleted`<span class="type">INT</span>  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除，1 删除，0 未删除&#x27;</span>,</span><br><span class="line">    `create_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;用户表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="角色表"><a href="#角色表" class="headerlink" title="角色表"></a>角色表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `role`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `role` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;角色编号&#x27;</span>,</span><br><span class="line">    `name`<span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;角色名称&#x27;</span>,</span><br><span class="line">    `state`    <span class="type">INT</span>      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户状态，1 禁用，0 正常&#x27;</span>,</span><br><span class="line">    `user_id`       <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `deleted`<span class="type">INT</span>      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除，1 删除，0 未删除&#x27;</span>,</span><br><span class="line">    `create_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;角色表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="菜单资源表"><a href="#菜单资源表" class="headerlink" title="菜单资源表"></a>菜单资源表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `menu`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `menu` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED      <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;菜单编号&#x27;</span>,</span><br><span class="line">    `name`<span class="type">VARCHAR</span>(<span class="number">80</span>)       <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;菜单资源名称&#x27;</span>,</span><br><span class="line">    `url`<span class="type">VARCHAR</span>(<span class="number">150</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;菜单资源路径&#x27;</span>,</span><br><span class="line">    `state`    <span class="type">INT</span>        <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;菜单状态，1 禁用，0 正常&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;菜单资源表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="角色-菜单中间表"><a href="#角色-菜单中间表" class="headerlink" title="角色-菜单中间表"></a>角色-菜单中间表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `role_menu`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `role_menu` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;角色-菜单编号&#x27;</span>,</span><br><span class="line">    `role_id`       <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;角色编号&#x27;</span>,</span><br><span class="line">    `menu_id`       <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;菜单编号&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;角色-菜单中间表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="医生表"><a href="#医生表" class="headerlink" title="医生表"></a>医生表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `doctor`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `doctor` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;医生编号&#x27;</span>,</span><br><span class="line">    `id_card`<span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;身份证&#x27;</span>,</span><br><span class="line">    `phone`      <span class="type">VARCHAR</span>(<span class="number">30</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;手机&#x27;</span>,</span><br><span class="line">    `telephone` <span class="type">VARCHAR</span>(<span class="number">30</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;电话&#x27;</span>,</span><br><span class="line">    `sex`<span class="type">INT</span>              <span class="keyword">NOT</span> <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;性别，0 男，1 女&#x27;</span>,</span><br><span class="line">    `birthday`<span class="type">DATE</span>              <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;出生日期&#x27;</span>,</span><br><span class="line">    `age`<span class="type">INT</span>               <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    `email`         <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line">    `keshi`         <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;科室&#x27;</span>,</span><br><span class="line">    `xueli`         <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;学历&#x27;</span>,</span><br><span class="line">    `<span class="keyword">describe</span>`      <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;备注&#x27;</span>,</span><br><span class="line">    `in_time`<span class="type">DATE</span>              <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;入职时间&#x27;</span>,</span><br><span class="line">    `state`    <span class="type">INT</span>     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;状态，0 正常，1 离职&#x27;</span>,</span><br><span class="line">    `user_id`       <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `deleted`<span class="type">INT</span>   <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除，1 删除，0 未删除&#x27;</span>,</span><br><span class="line">    `create_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;医生表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="收费项目表"><a href="#收费项目表" class="headerlink" title="收费项目表"></a>收费项目表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `charge_project`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `charge_project` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED   <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;收费项编号&#x27;</span>,</span><br><span class="line">    `name`<span class="type">VARCHAR</span>(<span class="number">100</span>)     <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;收费项目名称&#x27;</span>,</span><br><span class="line">    `money`<span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)    <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;收费金额&#x27;</span>,</span><br><span class="line">    `user_id`       <span class="type">INT</span> UNSIGNED    <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `deleted`<span class="type">INT</span>          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除，1 删除，0 未删除&#x27;</span>,</span><br><span class="line">    `create_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;收费项目表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="药品表"><a href="#药品表" class="headerlink" title="药品表"></a>药品表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `drug`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `drug` (</span><br><span class="line">`id`                  <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;药品编号&#x27;</span>,</span><br><span class="line">    `url`      <span class="type">VARCHAR</span>(<span class="number">200</span>)     <span class="keyword">NOT</span> <span class="keyword">NULL</span>         COMMENT <span class="string">&#x27;药品图片URL&#x27;</span>,</span><br><span class="line">    `in_price`      <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)    <span class="keyword">NOT</span> <span class="keyword">NULL</span>         COMMENT <span class="string">&#x27;进价&#x27;</span>,</span><br><span class="line">    `out_price`      <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)    <span class="keyword">NOT</span> <span class="keyword">NULL</span>         COMMENT <span class="string">&#x27;售价&#x27;</span>,</span><br><span class="line">    `name`            <span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;药品名称&#x27;</span>,</span><br><span class="line">    `type`       <span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;药品类型&#x27;</span>,</span><br><span class="line">    `simple_description`  <span class="type">VARCHAR</span>(<span class="number">200</span>)         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;简单介绍&#x27;</span>,</span><br><span class="line">    `expiration_date`     <span class="type">VARCHAR</span>(<span class="number">100</span>)         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;保质期&#x27;</span>,</span><br><span class="line">    `detail_description`  <span class="type">VARCHAR</span>(<span class="number">255</span>)         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;详细描述&#x27;</span>,</span><br><span class="line">    `fatory`              <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;生厂家&#x27;</span>,</span><br><span class="line">    `direction`           <span class="type">VARCHAR</span>(<span class="number">200</span>)         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;服用说明&#x27;</span>,</span><br><span class="line">    `remark`              <span class="type">VARCHAR</span>(<span class="number">200</span>)         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;备注&#x27;</span>,</span><br><span class="line">    `number`              <span class="type">INT</span> UNSIGNED         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;药品库存&#x27;</span>,</span><br><span class="line">    `user_id`             <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `deleted`      <span class="type">INT</span>       <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除，1 删除，0 未删除&#x27;</span>,</span><br><span class="line">    `create_time`         DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`         DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;药品表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="挂号表"><a href="#挂号表" class="headerlink" title="挂号表"></a>挂号表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `register`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `register` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;编号&#x27;</span>,</span><br><span class="line">    `id_card`<span class="type">VARCHAR</span>(<span class="number">50</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>       COMMENT <span class="string">&#x27;身份证&#x27;</span>,</span><br><span class="line">    `medical`      <span class="type">VARCHAR</span>(<span class="number">50</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;社保号&#x27;</span>,</span><br><span class="line">    `price`     <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)    <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;挂号费&#x27;</span>,</span><br><span class="line">    `phone`         <span class="type">VARCHAR</span>(<span class="number">30</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;联系电话&#x27;</span>,</span><br><span class="line">    `self_price`<span class="type">INT</span>    <span class="keyword">NOT</span> <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;是否自费：0自费 1免费&#x27;</span>,</span><br><span class="line">    `sex`<span class="type">INT</span>  <span class="keyword">NOT</span> <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;性别：0男 1女&#x27;</span>,</span><br><span class="line">    `age`<span class="type">INT</span>               <span class="keyword">NULL</span>   COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    `work`          <span class="type">VARCHAR</span>(<span class="number">80</span>)          <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;职业&#x27;</span>,</span><br><span class="line">    `look_doctor`   <span class="type">INT</span>  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;初复诊：0初诊 1复诊&#x27;</span>,</span><br><span class="line">    `remark`        <span class="type">VARCHAR</span>(<span class="number">200</span>)         <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;备注&#x27;</span>,</span><br><span class="line">    `state`    <span class="type">INT</span>  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;状态：0挂号 1已住院 2已出院 3已退号&#x27;</span>,</span><br><span class="line">    `doctor_id`     <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;医生编号&#x27;</span>,</span><br><span class="line">    `user_id`       <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `deleted`<span class="type">INT</span>  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除：1删除 0未删除&#x27;</span>,</span><br><span class="line">    `create_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`   DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;挂号表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="住院表"><a href="#住院表" class="headerlink" title="住院表"></a>住院表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `be_hospital`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `be_hospital` (</span><br><span class="line">`id`                  <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;病人编号&#x27;</span>,</span><br><span class="line">    `nurse_people`  <span class="type">VARCHAR</span>(<span class="number">30</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>         COMMENT <span class="string">&#x27;护理人&#x27;</span>,</span><br><span class="line">    `pat_bed`            <span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;病床号&#x27;</span>,</span><br><span class="line">    `antecedent`  <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)    <span class="keyword">NOT</span> <span class="keyword">NULL</span>         COMMENT <span class="string">&#x27;交纳押金&#x27;</span>,</span><br><span class="line">    `illness`            <span class="type">VARCHAR</span>(<span class="number">80</span>)      <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;病情介绍&#x27;</span>,</span><br><span class="line">    `close_price`  <span class="type">INT</span>    <span class="keyword">NOT</span> <span class="keyword">NULL</span>     COMMENT <span class="string">&#x27;结算状态：0未结清 1已结清&#x27;</span>,</span><br><span class="line">    `state`      <span class="type">INT</span>    <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;状态：0正常 1删除&#x27;</span>,</span><br><span class="line">    `user_id`             <span class="type">INT</span> UNSIGNED     <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;用户编号&#x27;</span>,</span><br><span class="line">    `deleted`      <span class="type">INT</span>    <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;删除，1 删除，0 未删除&#x27;</span>,</span><br><span class="line">    `create_time`         DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>     COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">    `update_time`         DATETIME         <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span>  <span class="built_in">CURRENT_TIMESTAMP</span>   <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;住院表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="药品-病人中间表"><a href="#药品-病人中间表" class="headerlink" title="药品-病人中间表"></a>药品-病人中间表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `drug_people`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `drug_people` (</span><br><span class="line">`id`            <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;药品-病人编号&#x27;</span>,</span><br><span class="line">    `drug_id`       <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;药品编号&#x27;</span>,</span><br><span class="line">    `patient_id`    <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;病人编号&#x27;</span>,</span><br><span class="line">    `number`        <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;药品数量&#x27;</span>,</span><br><span class="line">    `give_number`   <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;已发药品数量&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;药品-病人中间表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="收费项-病人中间表"><a href="#收费项-病人中间表" class="headerlink" title="收费项-病人中间表"></a>收费项-病人中间表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `price_people`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `price_people` (</span><br><span class="line">`id`              <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>  <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="string">&#x27;收费项-病人编号&#x27;</span>,</span><br><span class="line">    `charge_id`     <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;收费项编号&#x27;</span>,</span><br><span class="line">    `patient_id`          <span class="type">INT</span> UNSIGNED  <span class="keyword">NOT</span> <span class="keyword">NULL</span>          COMMENT <span class="string">&#x27;病人编号&#x27;</span></span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8mb4</span><br><span class="line">  <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_bin</span><br><span class="line">  ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span></span><br><span class="line">  COMMENT <span class="string">&#x27;收费项-病人中间表&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="设计中的问题"><a href="#设计中的问题" class="headerlink" title="设计中的问题"></a>设计中的问题</h3><p>表中定义字段的类型为 <code>TINYINT</code> 时，使用 MyBatis 反向生成器生成的实体类的类型为 <code>Byte</code>，本文在之前是使用 <code>TINYINT</code> 类型，发现这个问题之后，将其改为 <code>INT</code> 类型。</p><p>数据库创建成功后如图所示。</p><img src="/img/hospital/20.png"  />]]></content>
      
      
      <categories>
          
          <category> 医院项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 医院项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>医院项目环境搭建</title>
      <link href="/2022/07/17/%E5%8C%BB%E9%99%A2%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2022/07/17/%E5%8C%BB%E9%99%A2%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="医院项目环境搭建"><a href="#医院项目环境搭建" class="headerlink" title="医院项目环境搭建"></a>医院项目环境搭建</h2><h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><p>使用 IDEA 工具新建一个 hospital 的 maven 工程项目。</p><p>新建项目。</p><img src="/img/hospital/01.png" style="zoom: 33%;" /><p>选择 Maven 工程来创建工程，JDK 使用1.8版本。</p><img src="/img/hospital/02.png" style="zoom:33%;" /><p>项目名称，项目存放路径及项目包结构的配置。</p><img src="/img/hospital/03.png" style="zoom:33%;" /><p>创建项目成功之后，配置项目的web.xml，首先新建webapp目录，用于存放 web.xml 文件。</p><img src="/img/hospital/04.png" style="zoom: 25%;" /><p>根据下图所示，添加 webapp 目录。</p><img src="/img/hospital/06.png" style="zoom: 25%;" /><p>添加 web.xml 文件。</p><img src="/img/hospital/07.png" style="zoom:25%;" /><p>配置 web.xml 文件。</p><img src="/img/hospital/08.png" style="zoom:25%;" /><p>配置项目的 war 包文件。</p><img src="/img/hospital/09.png" style="zoom:25%;" /><p>到这里项目就创建完成。</p><img src="/img/hospital/10.png" style="zoom:25%;" /><h3 id="引入-jar-依赖"><a href="#引入-jar-依赖" class="headerlink" title="引入 jar 依赖"></a>引入 jar 依赖</h3><p>在 <code>pom.xml</code> 文件中添加下面代码，引入项目的相关依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--添加打包方式，将项目打成war包--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!--SSM整合：spring springMVC mybatis mysql等 --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 集中定义依赖版本号 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.2.13.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.5.6<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mybatis.spring.version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">mybatis.spring.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">pagehelper.version</span>&gt;</span>5.1.10<span class="tag">&lt;/<span class="name">pagehelper.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>8.0.23<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">druid.version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">druid.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-api.version</span>&gt;</span>4.0.1<span class="tag">&lt;/<span class="name">servlet-api.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">jackson.version</span>&gt;</span>2.9.6<span class="tag">&lt;/<span class="name">jackson.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">log4j.version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">log4j.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">junit.version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">junit.version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- spring --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aspects<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 文件上传 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Mybatis --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- mybatis和spring整合依赖 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 分页插件 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;pagehelper.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- MySql --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- 连接池 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;druid.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- servlet --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;servlet-api.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- Jackson Json处理工具包 --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;jackson.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- log4j --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;log4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- junit --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;junit.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--@Resource注解的依赖--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- 插件配置 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span><span class="comment">&lt;!--所在的目录--&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                   <span class="comment">&lt;!--包括目录下的.properties,.xml 文件都会被扫描到--&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>false<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.*<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"></span><br><span class="line">       <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!-- 设置项目的编译版本 --&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!-- 设置tomcat插件 --&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                   <span class="comment">&lt;!-- 指定端口 --&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">port</span>&gt;</span>8088<span class="tag">&lt;/<span class="name">port</span>&gt;</span></span><br><span class="line">                   <span class="comment">&lt;!-- 请求路径 --&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">path</span>&gt;</span>/<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">uriEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">uriEncoding</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!--反向生成插件--&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                   <span class="comment">&lt;!--配置文件的路径--&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">configurationFile</span>&gt;</span>src/main/resources/generatorConfig.xml<span class="tag">&lt;/<span class="name">configurationFile</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">overwrite</span>&gt;</span>true<span class="tag">&lt;/<span class="name">overwrite</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                       <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="编写-MyBatis-配置文件"><a href="#编写-MyBatis-配置文件" class="headerlink" title="编写 MyBatis 配置文件"></a>编写 MyBatis 配置文件</h3><p>在 resource 目录下新建 MyBatis 的配置文件：<code>mybatis.xml</code>。</p><blockquote><p>文件代码：</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring 接管其他的工作 数据源 映射文件注册 插件--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里 MyBatis 管理日志，所以需要配置日志的配置文件：<code>log4j.properties</code>。</p><blockquote><p>文件代码：</p></blockquote><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Global logging configuration info warning error</span></span><br><span class="line"><span class="attr">log4j.rootLogger</span>=<span class="string">DEBUG,stdout</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="attr">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] - %m%n</span></span><br></pre></td></tr></table></figure><p>MyBatis 的其他工作由 Spring 接管。</p><h3 id="编写-Spring-配置文件"><a href="#编写-Spring-配置文件" class="headerlink" title="编写 Spring 配置文件"></a>编写 Spring 配置文件</h3><p>在 resource 目录下新建 Spring 的配置文件：<code>spring.xml</code>。</p><blockquote><p>文件代码：</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd &quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--扫描包的配置：这些包中添加注解之后对象的创建权限就交给spring容器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.hospital.mapper,com.hospital.service&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- spring 整合mybatis部分 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--扫描并读取jdbc的配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath*:jdbc.properties&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--创建数据源--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--驱动可以省略，根据url自动检查出驱动--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--创建 sqlSessionFactory--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如果有mybatis的单独配置文件，需要在这里引入mybatis的配置文件--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis.xml&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置类型别名--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;typeAliasesPackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.hospital.pojo&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--配置映射文件扫描--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:com/hospital/mapper/*.xml&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--插件配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;plugins&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--分页插件配置--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;properties&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">                            reasonable=true</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 映射mybatis的目录 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Mapper接口所在的包名，spring自动查询指定包下的mapper，有了MapperScannerConfigurer，</span></span><br><span class="line"><span class="comment">    就不需要我们去为每个映射接口去声明一个bean了。大大缩减了开发的效率。--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mapperScannerConfigurer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sqlSessionFactory&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.hospital.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 通过注解方式实现事务 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Spring 配置文件中有涉及到数据库的连接，所以需要配置连接数据库的参数配置文件：<code>jdbc.properties</code>。</p><blockquote><p>文件代码：</p></blockquote><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">jdbc.driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">jdbc.url</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/hospital?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=GMT</span></span><br><span class="line"><span class="attr">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">jdbc.password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure><h3 id="编写-SpringMVC-配置文件"><a href="#编写-SpringMVC-配置文件" class="headerlink" title="编写 SpringMVC 配置文件"></a>编写 SpringMVC 配置文件</h3><p>在 resource 目录下新建 SpringMVC 的配置文件：<code>springmvc.xml</code>。</p><blockquote><p>文件代码：</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--springmvc的配置文件:控制器的bean对象都在这里扫描--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.hospital.controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--视图解析器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;internalResourceViewResolver&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--静态资源处理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/assets/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/assets/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/Css/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/Css/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/Doctor/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/doctor/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/front/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/front/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/hospital/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/hospital/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/Images/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/Images/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/Js/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/Js/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/medicine/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/medicine/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/registration/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/registration/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/Resource/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/Resource/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/Role/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/Role/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/User/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/User/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/index/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/index/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--文件上传--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意：在配置文件的过程中，需要新建包，否则会报错，下图为项目的结构：</p><img src="/img/hospital/11.png" style="zoom:25%;" /><h3 id="添加前端的静态资源文件"><a href="#添加前端的静态资源文件" class="headerlink" title="添加前端的静态资源文件"></a>添加前端的静态资源文件</h3><p>在 webapp 目录下添加提供的静态资源文件。</p><img src="/img/hospital/12.png" style="zoom:33%;" /><h3 id="编写-web-xml-配置文件"><a href="#编写-web-xml-配置文件" class="headerlink" title="编写 web.xml 配置文件"></a>编写 web.xml 配置文件</h3><blockquote><p>文件代码：</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/index/index.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--spring的配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--contextConfigLocation：表示用于加载 Bean的配置文件</span></span><br><span class="line"><span class="comment">        classpath和classpath*区别：</span></span><br><span class="line"><span class="comment">        classpath：只会到你的class路径中查找找文件。</span></span><br><span class="line"><span class="comment">        classpath*：不仅包含class路径，还包括jar文件中（class路径）进行查找。</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath*:spring.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener</span><br><span class="line">        <span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--SpringMVC的配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet</span><br><span class="line">        <span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 创建前端控制器的时候读取springmvc配置文件启动ioc容器 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath*:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Tomcat启动就创建此对象 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置拦截路径url，所有请求都会被前端控制器拦截处理 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用Rest风格的URI 将页面普通的post请求转为指定的delete或者put请求</span></span><br><span class="line"><span class="comment">    原理：在Ajax中发送post请求后，带_method参数，将其修改为PUT，或者DELETE请求--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>httpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span></span><br><span class="line">            org.springframework.web.filter.HiddenHttpMethodFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>httpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--注册字符集过滤器：post请求中文乱码问题的解决方案--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter</span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定字符集--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--强制request使用字符集encoding--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceRequestEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--强制response使用字符集encoding--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>点击Maven 下的 tomcat 插件启动项目。</p><p><img src="/img/hospital/14.png"></p><p>项目启动后，访问 <a href="http://localhost:8088，能访问到页面表示项目搭建成功。">http://localhost:8088，能访问到页面表示项目搭建成功。</a></p><p><img src="/img/hospital/13.png"></p><h3 id="搭建过程报错"><a href="#搭建过程报错" class="headerlink" title="搭建过程报错"></a>搭建过程报错</h3><p>在搭建的过程中，我启动 tomcat 测试时，会访问不了页面，如下图所示：</p><p><img src="/img/hospital/15.png"></p><p>通过查阅资料，找到了可能出现问题的原因是，我在pom.xml 文件下没有配置下面代码</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.*<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="/img/hospital/16.png" style="zoom:33%;" /><p>配置之后，就可以访问到前端页面。</p>]]></content>
      
      
      <categories>
          
          <category> 医院项目 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL环境搭建</title>
      <link href="/2022/07/14/MySQL%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2022/07/14/MySQL%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h2 id="MySQL环境搭建"><a href="#MySQL环境搭建" class="headerlink" title="MySQL环境搭建"></a>MySQL环境搭建</h2><p><strong>MySQL的4大版本</strong></p><blockquote><ul><li>MySQL Community Server 社区版本，开源免费，自由下载，但不提供官方技术支持，适用于大多数普通用户。</li><li>MySQL Enterprise Edition 企业版本，需付费，不能在线下载，可以试用30天。提供了更多的 功能和更完备的技术支持，更适合于对数据库的功能和可靠性要求较高的企业客户。</li><li>MySQL Cluster 集群版，开源免费。用于架设集群服务器，可将几个MySQL Server封装成一个 Server。需要在社区版或企业版的基础上使用。</li><li>MySQL Cluster CGE 高级集群版，需付费。</li></ul></blockquote><ul><li>目前最新版本为 <code>8.0.29</code> ，发布时间 <code>2022年4月26号</code>。8.0.0 版本是在2016年9月12日发布。</li><li>本文使用 <code>8.0.26</code> 的社区版。</li></ul><h3 id="1-MySQL的下载"><a href="#1-MySQL的下载" class="headerlink" title="1. MySQL的下载"></a>1. MySQL的下载</h3><p><strong>步骤1</strong>：打开MySQL官方地址：<a href="https://www.mysql.com/%E3%80%82">https://www.mysql.com/。</a></p><p><img src="/img/MySQL/1002.png"></p><p><strong>步骤2</strong>：进入官网后，点击 <strong>DOWNLOADS</strong>，进入下载页面。然后，点击 <strong>MySQL Community(GPL) Downloads</strong></p><p><img src="/img/MySQL/1003.png"></p><p><strong>步骤3</strong>：点击 <strong>MySQL Community Server</strong></p><p><img src="/img/MySQL/1004.png"></p><p><strong>步骤4</strong>：在 <strong>General Availability(GA) Releases</strong> 中选择适合的版本</p><p>Windows平台下提供两种安装文件：MySQL二进制分发版（.msi安装文件）和免安装版（.zip压缩文件）。</p><p>推荐使用<strong>二进制分发版</strong>进行安装，因为该版本提供了图形化的安装向导过程，比其他的分发版使用起来要简单，不再需要其他工具启动就可以运行MySQL。</p><ul><li>在 Windows 系统下推荐下载 MSI 安装程序，点击 <strong>Go to Download Page</strong> 进行下载。</li></ul><p><img src="/img/MySQL/1005.png"></p><ul><li>Windows 下的 MySQL8.0 安装有两种安装程序：<ul><li>mysql-installer-web-community-8.0.29.0.msi 下载程序大小：2.3M；安装时需要联网安装组件。 </li><li>mysql-installer-community-8.0.29.0.msi 下载程序大小：439.6M；安装时离线安装即可（<strong>推荐</strong>）。</li></ul></li></ul><p><img src="/img/MySQL/1006.png"></p><ul><li>本篇文章选择安装的是8.0.26版本，而现在最新版本为8.0.29，若要下载8.0.26版本，选择Archives，选择8.0.26版本下载。</li></ul><p><img src="/img/MySQL/1008.png"></p><ul><li>若要安装MySQL5.7版本的话，选择Archives，接着选择MySQL5.7的相应版本即可。本文下载MySQL5.7.34的版本。</li></ul><p><img src="/img/MySQL/1007.png"></p><p><strong>步骤5</strong>：下载MySQL安装包。注意：在下载安装包时，会弹出需要登录Oracle账户，本篇文章默认Oracle账户已登录的状态。MySQL安装包如下图所示。</p><p><img src="/img/MySQL/1009.png"></p><h3 id="2-MySQL8-0的安装"><a href="#2-MySQL8-0的安装" class="headerlink" title="2. MySQL8.0的安装"></a>2. MySQL8.0的安装</h3><p>MySQL下载完成后，找到下载文件，双击进行安装，具体操作步骤如下。</p><p><strong>步骤1</strong>：双击下载的 mysql-installer-community-8.0.26.0.msi 文件，打开安装向导。</p><img src="/img/MySQL/1010.png" style="zoom: 33%;" /><p><strong>步骤2</strong>：打开“<strong>Choosing a Setup Type</strong>”（选择安装类型）窗口，总有5种安装类型：</p><ul><li>Developer Default（默认安装类型）</li><li>Server only（仅作为服务器）</li><li>Client only（仅作为客户端）</li><li>Full（完全安装）</li><li>Custom（自定义安装）。</li></ul><p>这里选择“<strong>Custom</strong>”类型按钮，单击“<strong>Next</strong>(下 一步)”按钮。</p><img src="/img/MySQL/1011.png" style="zoom: 33%;" /><p><strong>步骤3</strong>：打开“<strong>Select Products</strong>” （选择产品）窗口，可以定制需要安装的产品清单。本文中，选择“MySQL Server 8.0.26-X64”后，单击“→”添加按钮，即可选择安装MySQL服务器，如图所示。采用通用的方法，可以添加其他需要安装的产品。</p><img src="/img/MySQL/1012.png" style="zoom: 33%;" /><p>此时如果直接“<strong>Next</strong>”（下一步），则产品的安装路径是默认的。如果想要自定义安装目录，则可以选中对应的产品，然后在下面会出现“<strong>Advanced Options</strong>”（高级选项）的超链接。</p><img src="/img/MySQL/1013.png" style="zoom: 33%;" /><p>单击“<strong>Advanced Options</strong>”（高级选项）则会弹出安装目录的选择窗口，此时可以分别设置 MySQL的服务程序安装目录和数据存储目录。如果不设置，默认分别在C盘的Program Files目录和 ProgramData目录（注意：这是隐藏目录）。如果自定义安装目录，自定义的目录必须没有中文。另外，建议安装目录和数据目录分开存放。</p><img src="/img/MySQL/1014.png" style="zoom:50%;" /><p><strong>步骤4</strong>：在上一步选择好自定义目录之后，点击“<strong>OK</strong>”，再单击“<strong>Next</strong>”（下一步）进入确认窗口。单击 “<strong>Execute</strong>”（执行）按钮开始安装。</p><img src="/img/MySQL/1015.png" style="zoom: 33%;" /><p><strong>步骤5</strong>：安装完成后在“<strong>Status</strong>”（状态）列表下将显示“<strong>Complete</strong>”（安装完成）。</p><img src="/img/MySQL/1016.png" style="zoom: 33%;" /><h3 id="3-MySQL的配置"><a href="#3-MySQL的配置" class="headerlink" title="3. MySQL的配置"></a>3. MySQL的配置</h3><p>MySQL安装之后，需要对服务器进行配置。具体的配置步骤如下。 </p><p><strong>步骤1</strong>：在安装完成后，单击“<strong>Next</strong>”（下一步）按钮，就可以进入产品配置窗口，如图所示。</p><img src="/img/MySQL/1017.png" style="zoom: 33%;" /><p><strong>步骤2</strong>：单击“<strong>Next</strong>”（下一步）按钮，进入MySQL服务器类型配置窗口，如图所示。端口号一般选择默认端口号3306。</p><img src="/img/MySQL/1018.png" style="zoom: 33%;" /><p>其中，“Config Type”选项用于设置服务器的类型。而服务器的类型共有三种，如图所示。</p><img src="/img/MySQL/1019.png" style="zoom: 33%;" /><ul><li>Development Computer（开发机器） ：该选项代表典型个人用桌面工作站。此时机器上需要运行多个应用程序，那么MySQL服务器将占用最少的系统资源。 </li><li>Server Computer（服务器） ：该选项代表服务器，MySQL服务器可以同其他服务器应用程序一起 运行，例如Web服务器等。MySQL服务器配置成适当比例的系统资源。 </li><li>Dedicated Computer（专用服务器） ：该选项代表只运行MySQL服务的服务器。MySQL服务器配置 成使用所有可用系统资源。</li></ul><p><strong>步骤3</strong>：单击“<strong>Next</strong>”（下一步）按钮，打开设置授权方式窗口。其中，上面的选项是MySQL8.0提供的新的授权方式，采用SHA256基础的密码加密方法；下面的选项是传统授权方法（保留5.x版本兼容性）。</p><img src="/img/MySQL/1020.png" style="zoom:33%;" /><p><strong>步骤4</strong>：单击“<strong>Next</strong>”（下一步）按钮，打开设置服务器root超级管理员的密码窗口，如图所示，需要输入两次同样的登录密码。也可以通过“Add User”添加其他用户，添加其他用户时，需要指定用户名、允许 该用户名在哪台&#x2F;哪些主机上登录，还可以指定用户角色等。此处暂不添加用户，用户管理在MySQL高级 特性篇中讲解。</p><img src="/img/MySQL/1021.png" style="zoom:33%;" /><p><strong>步骤5</strong>：单击“<strong>Next</strong>”（下一步）按钮，打开设置服务器名称窗口，如图所示。该服务名会出现在Windows 服务列表中，也可以在命令行窗口中使用该服务名进行启动和停止服务。本书将服务名设置为 “MySQL80”。如果希望开机自启动服务，也可以勾选“Start the MySQL Server at System Startup”选项（推 荐）。</p><p>下面是选择以什么方式运行服务？可以选择“Standard System Account”(标准系统用户)或者“Custom User” (自定义用户)中的一个。这里推荐前者。</p><img src="/img/MySQL/1022.png" style="zoom:33%;" /><p><strong>步骤6</strong>：单击“Next”（下一步）按钮，打开确认设置服务器窗口，单击“Execute”（执行）按钮。</p><img src="/img/MySQL/1023.png" style="zoom:33%;" /><p><strong>步骤7</strong>：完成配置，如图所示。单击“Finish”（完成）按钮，即可完成服务器的配置。</p><img src="/img/MySQL/1024.png" style="zoom:33%;" /><p><strong>步骤8</strong>：如果还有其他产品需要配置，可以选择其他产品，然后继续配置。如果没有，直接选择“Next” （下一步），直接完成整个安装和配置过程。</p><img src="/img/MySQL/1025.png" style="zoom: 33%;" /><p><strong>步骤9</strong>：结束安装和配置。</p><img src="/img/MySQL/1026.png" style="zoom: 33%;" /><h3 id="4-环境变量的配置"><a href="#4-环境变量的配置" class="headerlink" title="4. 环境变量的配置"></a>4. 环境变量的配置</h3><p>如果不配置MySQL环境变量，就不能在命令行直接输入MySQL登录命令。配置MySQL的环境变量步骤如下： </p><p><strong>步骤1</strong>：在桌面上右击【<strong>此电脑</strong>】图标，在弹出的快捷菜单中选择【<strong>属性</strong>】菜单命令。 </p><p><strong>步骤2</strong>：打开【<strong>系统</strong>】窗口，单击【<strong>高级系统设置</strong>】链接。 </p><p><strong>步骤3</strong>：打开【<strong>系统属性</strong>】对话框，选择【<strong>高级</strong>】选项卡，然 后单击【<strong>环境变量</strong>】按钮。 </p><p><strong>步骤4</strong>：打开【<strong>环境变量</strong>】对话框，在系统变量列表中选择path变量。 </p><p><strong>步骤 5</strong>：单击【<strong>编辑</strong>】按钮，在【<strong>编辑环境变量</strong>】对话框中，将MySQL应用程序的bin目录（D:\software\MySQL\MySQL Server 8.0\bin）添加到变量值中，用分号将其与其他路径分隔开。 </p><p><strong>步骤6</strong>：添加完成 之后，单击【确定】按钮，这样就完成了配置path变量的操作，然后就可以直接输入MySQL命令来登录数据库了。</p><img src="/img/MySQL/1027.png" style="zoom: 25%;" /><h3 id="5-查询版本测试"><a href="#5-查询版本测试" class="headerlink" title="5. 查询版本测试"></a>5. 查询版本测试</h3><p>使用”win+r“快捷键调出黑框，输入 <code>mysql --version</code>  命令查询MySQL的版本号。如图所示，表示安装MySQL成功。</p><img src="/img/MySQL/1028.png" style="zoom:38%;" />]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL索引详解</title>
      <link href="/2022/07/12/MySQL%E7%B4%A2%E5%BC%95%E8%AF%A6%E8%A7%A3/"/>
      <url>/2022/07/12/MySQL%E7%B4%A2%E5%BC%95%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h3 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h3><p>server 流程的组件：连接器 –&gt; 分析器 –&gt; 优化器 –&gt; 执行器</p><ul><li><p>连接器：管理连接、验证权限</p></li><li><p>分析器：词法分析、语法分析</p></li><li><p>优化器：<strong>CBO</strong>（基于成本的优化，使用比较广泛）、RBO（基于规则的优化），组件无法进行控制。</p></li><li><p>执行器：用来跟存储引擎直接做交互</p></li></ul><p>存储引擎：innodb，myisam，menory </p><ul><li>含义：不同的数据文件在磁盘的不同组织形式</li></ul><p>innodb 与 myisam 的区别</p><ul><li>innodb 支持事务，myisam不支持</li><li>innodb支持外键，myisam不支持</li><li>innodb支持表锁和行锁，myisam只支持表锁</li><li>innodb在5.6版本之后支持全文检索，而myisam一直支持</li><li>innodb索引的叶子节点直接存放数据，而myisam存放地址</li></ul><p>innodb功能这么强大，为什么还要用myisam</p><blockquote><p>myisam是MySQL自带的原生的存储引擎，而innodb是另外一家公司开发出来的一个插件的存储引擎。在用innodb时，发现其强大之处，所以将innodb集成到MySQL里面去，而MySQL从5.5版本之后，默认的版本是innodb而不是myisam。</p><p>但myisam有一个强大的点：统计总数。</p></blockquote><p>全文索引</p><blockquote><p>案例：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有一张名为 content 的表，表中字段有 id、content、title，现在需要把这张表中 content 字段包含 java 关键字的文章都取出来，怎么操作？</span><br></pre></td></tr></table></figure><p>全文检索类似于java里面的ES（ElasticSearch），ES前身是solr，在solr之前是lucene，这些都是Java中专门做全文检索的。</p><p>在MySQL中很少用全文检索，知道其基本概念即可。</p></blockquote><p>SQL解析：antlr</p><p>扩展知识</p><blockquote><p>数据库的 token</p><p>shardingsphere 组件：用于对应的分库分表，apache的顶级项目。</p></blockquote><h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><p><strong>哪些数据结构可以存储键值对</strong></p><ul><li>hash</li><li>树</li></ul><p>MySQL中menory存储引擎使用hash索引，同时innodb支持自适应hash</p><p>局部性原理：数据和程序都有集聚成群的倾向，分为空间局部性和时间局部性</p><p>磁盘预读：内存跟磁盘在进行交互的时候要保证每次读取需要一个逻辑单位，而这个逻辑单位叫做页，或者叫 datapage，一般都是4k或者8k，在进行读取的时候，一般都是4k的整数倍。例如，innodb每次读取16kb的数据。</p><p>MySQL在众多树中，为什么选择B+树来存储键值对？</p><blockquote><p>B+树相比其它树，优势：</p><ul><li>是多叉树</li><li>节点有序</li><li>是一颗平衡树</li><li>每一个节点可以存储多条记录</li></ul></blockquote><p>MySQL的索引一般有几层？</p><blockquote><p>一般情况下，3到4层就足以支撑千万级别的表查询。</p></blockquote><p>创建索引的字段是长了好还是短了好？</p><blockquote><p>短了好。原因是在层数不变的情况下，可以存储更多的数据量。</p></blockquote><p>在创建表的时候，是用代理主键还是自然主键？</p><blockquote><ul><li>代理主键：跟业务无关的列；</li><li>自然主键：跟业务相关的列</li></ul><p>能使用代理主键尽可能多的使用代理主键</p></blockquote><p>主键设置好之后，要不要自增？</p><blockquote><p>在满足业务的情况下，尽可能自增。不自增会增加索引的维护成本。</p></blockquote><p>在分布式应用场景中，自增id还适用吗？</p><blockquote><p>不能适用。使用雪花算法（snowflake），也称自定义id生成器</p></blockquote><p>面试问题还有：回表、索引覆盖、最左匹配、索引下推等名词的理解。</p><p>聚簇索引与非聚簇索引的区别：数据跟索引是否聚集存储 。</p><blockquote><p>innodb的主键索引就是聚簇索引：</p><blockquote><p>必须要包含一个主键列的：key。如果在创建表的时候制定了主键，那么key就是主键；如果没有主键，那么key就是唯一键；如果唯一键也没有，那么key就是6字节的rowid。</p></blockquote><p>6字节的rowid够不够存？</p><blockquote><p>够</p></blockquote></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Hexo和GitHub搭建个人博客</title>
      <link href="/2022/07/11/%E4%BD%BF%E7%94%A8Hexo%E5%92%8CGitHub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2022/07/11/%E4%BD%BF%E7%94%A8Hexo%E5%92%8CGitHub%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>本篇是记录我使用 Hexo 和 GitHub 搭建一个免费的个人博客的过程。 </p><h2 id="安装-Git"><a href="#安装-Git" class="headerlink" title="安装 Git"></a>安装 Git</h2><h2 id="安装-Nodejs"><a href="#安装-Nodejs" class="headerlink" title="安装 Nodejs"></a>安装 Nodejs</h2><h2 id="GitHub-环境配置"><a href="#GitHub-环境配置" class="headerlink" title="GitHub 环境配置"></a>GitHub 环境配置</h2><h2 id="使用-Hexo-搭建个人博客"><a href="#使用-Hexo-搭建个人博客" class="headerlink" title="使用 Hexo 搭建个人博客"></a>使用 Hexo 搭建个人博客</h2><h2 id="选择-Hexo-主题"><a href="#选择-Hexo-主题" class="headerlink" title="选择 Hexo 主题"></a>选择 Hexo 主题</h2><h2 id="主题配置"><a href="#主题配置" class="headerlink" title="主题配置"></a>主题配置</h2>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
